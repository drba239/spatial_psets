(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    142119,       3656]
NotebookOptionsPosition[    136081,       3562]
NotebookOutlinePosition[    136507,       3578]
CellTagsIndexPosition[    136464,       3575]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"$HistoryLength", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "SetDirectory", "[", 
   "\"\<C:\\\\Users\\\\Samuel Zhao\\\\OneDrive\\\\Documents\\\\CMLEE\>\"", 
   "]"}], ";"}]}], "Input",
 CellLabel->"In[89]:=",ExpressionUUID->"0e367fcf-046a-6940-8c58-b6f3b63fe78e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Workplace", " ", "data"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"workplaceEmp", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{
      "Import", "[", "\"\<simulation inputs\\\\workplaceEmp.csv\>\"", "]"}], 
      "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"number", " ", "of", " ", "jobs"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"workplaceWage", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{
      "Import", "[", "\"\<simulation inputs\\\\workplaceWage.csv\>\"", "]"}], 
      "]"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "average", " ", "yearly", " ", "wage", " ", "of", " ", "a", " ", "job", 
      " ", "by", " ", "workplace"}], ",", " ", "dollars"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"laborIncome", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"workplaceEmp", " ", "workplaceWage"}], ")"}], "/", 
      SuperscriptBox["10", "6"]}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "total", " ", "payment", " ", "to", " ", "workers", " ", "in", " ", "a", 
      " ", "workplace"}], ",", " ", 
     RowBox[{"in", " ", "millions"}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Residence", " ", "data"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"resWage", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{
      "Import", "[", "\"\<simulation inputs\\\\residentialWage.csv\>\"", 
       "]"}], "]"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "average", " ", "yearly", " ", "wage", " ", "of", " ", "a", " ", "job", 
      " ", "by", " ", "residence"}], ",", " ", "dollars"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"resEmp", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{
      "Import", "[", "\"\<simulation inputs\\\\residentialEmp.csv\>\"", "]"}],
       "]"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
    "number", " ", "of", " ", "residents", " ", "in", " ", "a", " ", 
     "residential", " ", "location"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"resIncome", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{
      "Import", "[", "\"\<simulation inputs\\\\resIncome.csv\>\"", "]"}], 
      "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"total", " ", "residential", " ", "income"}], ",", " ", 
     "millions"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"bilateral", " ", "distances"}], "*)"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"distancesOnlyTrading", "=", 
     RowBox[{
     "Import", "[", "\"\<simulation inputs\\\\distances_onlytrading.csv\>\"", 
      "]"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "when", " ", "two", " ", "counties", " ", "do", " ", "not", " ", 
      "trade"}], ",", " ", 
     RowBox[{
      RowBox[{"distance", " ", "is", " ", 
       SuperscriptBox["10", "9"]}], ";", " ", 
      RowBox[{
      "a", " ", "row", " ", "is", " ", "an", " ", "origin", " ", "county"}]}],
      ",", " ", 
     RowBox[{
      RowBox[{"selling", " ", "to", " ", "all", " ", "destination"}], "-", 
      RowBox[{"columns", " ", "counties", " ", 
       RowBox[{"(", 
        RowBox[{"see", " ", "below", " ", "as", " ", "well"}], ")"}]}]}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"distancesAllPairs", "=", 
     RowBox[{
     "Import", "[", "\"\<simulation inputs\\\\distances_allpairs.csv\>\"", 
      "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "distances", " ", "when", " ", "all", " ", "counties", " ", "are", " ", 
      "allowed", " ", "to", " ", "trade"}], " ", "-", " ", 
     RowBox[{"all", " ", "bilateral", " ", "distances"}]}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "commuters", " ", "residing", " ", "in", " ", "a", " ", "row", " ", 
     "location", " ", "and", " ", "working", " ", "in", " ", "a", " ", 
     "column", " ", "location"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Lambda]", "=", 
     RowBox[{
     "Import", "[", "\"\<simulation inputs\\\\commuting_flows.csv\>\"", 
      "]"}]}], ";"}], "  ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"land", " ", "area"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"landArea", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{
      "Import", "[", "\"\<simulation inputs\\\\land_area.csv\>\"", "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "other", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"countyNames", "=", 
     RowBox[{
     "Import", "[", "\"\<simulation inputs\\\\county_names.csv\>\"", "]"}]}], 
    ";"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ncounties", "=", 
     RowBox[{"Length", "[", "workplaceEmp", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mfgShares", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{
      "Import", "[", "\"\<simulation inputs\\\\mfg_shares.csv\>\"", "]"}], 
      "]"}]}], ";"}]}]}]], "Input",
 CellLabel->"In[91]:=",ExpressionUUID->"a6207549-691b-7f47-b1c4-059b2afe603e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"saiz", " ", "implied", " ", "population", " ", "elasticities"}], 
   "*)"}], " ", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Eta]zero", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0.", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "ncounties"}], "}"}]}], "]"}]}], ";"}], 
   " ", 
   RowBox[{"(*", 
    RowBox[{"baseline", " ", "model", " ", "elasticity"}], "*)"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Eta]exf", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{
      "Import", "[", 
       "\"\<simulation inputs\\\\saiz_price_elasticities.csv\>\"", "]"}], 
      "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
    "elasticities", " ", "for", " ", "main", " ", "exercise", " ", "with", 
     " ", "positive", " ", "land", " ", "supply"}], "*)"}]}]}]], "Input",
 CellLabel->
  "In[106]:=",ExpressionUUID->"0dd42738-babb-f640-8f8a-f4eb5cecf765"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"beaCfs", "=", 
   RowBox[{
   "Import", "[", "\"\<simulation inputs\\\\bea_cfs_list.csv\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "beaCfs", "]"}], "\[IndentingNewLine]", 
 RowBox[{"beaCfs", "[", 
  RowBox[{"[", 
   RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], "Input",
 CellLabel->
  "In[108]:=",ExpressionUUID->"bcf6df65-b212-9e4c-aa51-94571a979388"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3111", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{3.946572386287895*^9},
 CellLabel->
  "Out[109]=",ExpressionUUID->"172ce6c3-2bb9-124f-8b3e-4d0ee9330fb8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "4"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.9465723863039703`*^9},
 CellLabel->
  "Out[110]=",ExpressionUUID->"34d35363-5cf8-a849-aa84-f063e5ba751b"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]", "=", 
    RowBox[{
     RowBox[{"-", "1.2922"}], "/", 
     RowBox[{"(", 
      RowBox[{"1", "-", "\[Sigma]"}], ")"}]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"this", " ", "\[Psi]", 
     RowBox[{"(", 
      RowBox[{"1", "-", "\[Sigma]"}], ")"}], " ", "comes", " ", "from", " ", 
     "the", " ", "estimated", " ", "gravity", " ", "coefficient", " ", "on", 
     " ", "CFS"}], "-", 
    RowBox[{"level", " ", "regressions"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]", "=", "0.6"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Epsilon]", "=", "3.3035"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]", " ", "=", 
   RowBox[{"4.4295", "/", "\[Epsilon]"}]}], ";"}]}], "Input",
 CellLabel->
  "In[111]:=",ExpressionUUID->"57f2f3bf-7fef-7844-b4ca-36755c2c62b6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"isCommuting", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Lambda]", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[Equal]", "0"}], ",", "0", 
       ",", "1"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "ncounties"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "ncounties"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"isCommutingSp", "=", 
   RowBox[{"SparseArray", "[", "isCommuting", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"isNoCommuting", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"Table", "[", 
     RowBox[{"1", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "ncounties"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"isNoCommutingSp", "=", 
   RowBox[{"SparseArray", "[", "isNoCommuting", "]"}]}], ";"}]}], "Input",
 CellLabel->
  "In[116]:=",ExpressionUUID->"c20e2123-af1c-bd4c-9712-c1ef4aa05c9a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"population", "=", 
   RowBox[{"Total", "[", "workplaceEmp", "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[120]:=",ExpressionUUID->"0016ae11-3f43-4c40-8224-938df79d7772"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rhsProductivities", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"prod", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"num", ",", "_Real", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"expenditure", ",", "_Real", ",", "1"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "bilatRes", ",", "multResistance", ",", "effDemand", ",", "leh"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"bilatRes", "=", 
         RowBox[{"num", " ", "prod"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{"proportional", " ", "to", " ", "bilateral", " ", "cost"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"multResistance", "=", 
         RowBox[{"Total", "[", "bilatRes", "]"}]}], ";", " ", 
        RowBox[{"(*", 
         RowBox[{"denominator", " ", "in", " ", "RHS"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"effDemand", "=", 
         RowBox[{"expenditure", "/", "multResistance"}]}], ";", " ", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"income", "/", "denominator"}], " ", "in", " ", "RHS"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"leh", "=", " ", 
         RowBox[{"bilatRes", ".", "effDemand"}]}], ";", " ", 
        "\[IndentingNewLine]", "leh"}]}], "\[IndentingNewLine]", "]"}]}], 
    RowBox[{"(*", 
     RowBox[{
     "RHS", " ", "with", " ", "current", " ", "guess", " ", "of", " ", 
      "productivity"}], "*)"}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[121]:=",ExpressionUUID->"bbe0bb9b-c140-a245-b586-ff7fa436b977"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"productivities", "[", 
    RowBox[{
    "workemp_", ",", "workwage_", ",", "resExp_", ",", "distmatrix_", ",", 
     "detailsYN_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "A0", ",", "\[Lambda]", ",", "tol", ",", "c", ",", "dist", ",", 
       "distmin", ",", "gap", ",", "labIncomeHat", ",", "A1", ",", "den", ",",
        "numerators", ",", "labIncome"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Lambda]", "=", "0.7"}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{"step", " ", "size"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"A0", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"1.", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "ncounties"}], "}"}]}], "]"}]}], ";", 
      " ", 
      RowBox[{"(*", 
       RowBox[{
       "initial", " ", "condition", " ", "for", " ", "productivities"}], 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"tol", "=", 
       SuperscriptBox["10", 
        RowBox[{"-", "6"}]]}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{"tolerance", " ", "level"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"c", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"dist", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"numerators", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"workemp", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            FractionBox["workwage", 
             SuperscriptBox["10", "4"]], ")"}], 
           RowBox[{"1", "-", "\[Sigma]"}]]}], " ", ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", "distmatrix", ")"}], 
         RowBox[{"\[Psi]", 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Sigma]"}], ")"}]}]]}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"labIncome", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"workemp", " ", "workwage"}], ")"}], "/", 
        SuperscriptBox["10", "6"]}]}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{
       "left", " ", "hand", " ", "side", " ", "of", " ", "trade", " ", 
        "flows", " ", "equation"}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{
         "Note", " ", "that", " ", "the", " ", "iterations", " ", "solve", 
          " ", "for", " ", 
          SuperscriptBox["A", 
           RowBox[{"\[Sigma]", "-", "1"}]]}], ";", " ", 
         RowBox[{"before", " ", "returning", " ", "the", " ", "output"}]}], 
        ",", " ", 
        RowBox[{
        "these", " ", "guesses", " ", "are", " ", "rescaled", " ", "to", " ", 
         "the", " ", 
         RowBox[{"1", "/", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Sigma]", "-", "1"}], ")"}], "."}]}]}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"dist", ">", "tol"}], " ", "&&", "  ", 
         RowBox[{"c", "<", "10000"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"c", "=", 
          RowBox[{"c", "+", "1"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"New", " ", "labor", " ", "Expenditure"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"labIncomeHat", "=", 
          RowBox[{"rhsProductivities", "[", 
           RowBox[{"A0", ",", "numerators", ",", "resExp"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         " ", 
         RowBox[{"(*", 
          RowBox[{
          "Relative", " ", "gap", " ", "in", " ", "labor", " ", 
           "expenditure"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"gap", "=", 
          RowBox[{"labIncome", " ", "/", "labIncomeHat"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"dist", "=", 
          RowBox[{"Max", "[", 
           RowBox[{"Abs", "[", 
            RowBox[{"gap", "-", "1"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"distmin", "=", 
          RowBox[{"Min", "[", 
           RowBox[{"Abs", "[", 
            RowBox[{"gap", "-", "1"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
         RowBox[{"(*", 
          RowBox[{"new", " ", "guess", " ", "of", " ", "productivity"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"A1", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Lambda]", " ", "+", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "\[Lambda]"}], ")"}], "gap"}]}], ")"}], 
           "A0"}]}], ";", " ", "\[IndentingNewLine]", 
         RowBox[{"den", "=", 
          RowBox[{"Mean", "[", "A1", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"A0", "=", 
          RowBox[{"A1", "/", "den"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", "diagnostics", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{"c", ",", "50"}], "]"}], "\[Equal]", "1"}], "  ", "&&", 
            " ", 
            RowBox[{"dist", ">", "0.01"}], " ", "&&", " ", 
            RowBox[{"detailsYN", "\[Equal]", "1"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Block", "[", 
             RowBox[{
              RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{"\"\<end of iteration \>\"", ",", "c", ",", " ", 
                 RowBox[{"\"\< at \>\"", " ", 
                  RowBox[{"DateString", "[", "]"}]}], ",", " ", 
                 "\"\<; min gap: \>\"", ",", " ", "distmin", ",", 
                 "\"\<; max gap: \>\"", ",", "dist", ",", " ", " ", 
                 "\"\< - \>\"", ",", 
                 RowBox[{"Min", "[", "A0", "]"}], ",", "\"\< \>\"", ",", 
                 RowBox[{"Max", "[", "A0", "]"}]}], "]"}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"detailsYN", "\[Equal]", "1"}], ",", 
        RowBox[{"Block", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"\"\<end of iteration \>\"", ",", "c", ",", " ", 
             RowBox[{"\"\< at \>\"", " ", 
              RowBox[{"DateString", "[", "]"}]}], ",", " ", 
             "\"\<; max gap: \>\"", ",", "dist", ",", " ", "\"\< \>\"", ",", 
             RowBox[{"Min", "[", "A0", "]"}], ",", "\"\< \>\"", ",", 
             RowBox[{"Max", "[", "A0", "]"}]}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"A0", "=", 
       FractionBox[
        SuperscriptBox["A0", 
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{"\[Sigma]", "-", "1"}], ")"}]}]], 
        RowBox[{"Mean", "[", 
         SuperscriptBox["A0", 
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{"\[Sigma]", "-", "1"}], ")"}]}]], "]"}]]}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{
       "Recovering", " ", "productivities", " ", "from", " ", "the", " ", 
        SuperscriptBox["A", 
         RowBox[{"\[Sigma]", "-", "1"}]], " ", "values", " ", "that", " ", 
        "fit", " ", "the", " ", "data"}], "*)"}], "\[IndentingNewLine]", 
      "A0"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[122]:=",ExpressionUUID->"296030a4-96ee-1841-991d-5522d6ed0bee"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"trade", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"prod", ",", "_Real", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"workemp", ",", "_Real", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"workwage", ",", "_Real", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"expenditure", ",", "_Real", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"distmatrix", ",", "_Real", ",", "2"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "num", ",", "bilatRes", ",", "multResistance", ",", "share", ",", 
          "trade"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"num", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"workemp", " ", 
             SuperscriptBox[
              RowBox[{"(", 
               FractionBox["workwage", 
                SuperscriptBox["10", "4"]], ")"}], 
              RowBox[{"1", "-", "\[Sigma]"}]]}], " ", ")"}], " ", 
           SuperscriptBox[
            RowBox[{"(", "distmatrix", ")"}], 
            RowBox[{"\[Psi]", 
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Sigma]"}], ")"}]}]]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"bilatRes", "=", 
          RowBox[{"num", " ", 
           SuperscriptBox["prod", 
            RowBox[{"\[Sigma]", "-", "1"}]]}]}], ";", 
         RowBox[{"(*", 
          RowBox[{"proportional", " ", "to", " ", "bilateral", " ", "cost"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"multResistance", "=", 
          RowBox[{"Total", "[", "bilatRes", "]"}]}], ";", " ", 
         RowBox[{"(*", 
          RowBox[{"denominator", " ", "in", " ", "RHS"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"share", "=", 
          RowBox[{"Transpose", "[", 
           FractionBox[
            RowBox[{"Transpose", "[", "bilatRes", "]"}], "multResistance"], 
           " ", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"trade", "=", 
          RowBox[{"Transpose", "[", 
           RowBox[{
            RowBox[{"Transpose", "[", "share", "]"}], " ", "expenditure"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"share", ",", "trade"}], "}"}]}]}], "\[IndentingNewLine]", 
       "]"}]}], 
     RowBox[{"(*", 
      RowBox[{
      "RHS", " ", "with", " ", "current", " ", "guess", " ", "of", " ", 
       "productivity"}], "*)"}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellLabel->
  "In[123]:=",ExpressionUUID->"62e2888c-b85b-2d43-81a5-e476ad8dcb15"],

Cell[BoxData[
 RowBox[{
  RowBox[{"allChangesGuess", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"inWhat", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"in\[Lambda]", ",", "_Real", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"khat", ",", "_Real", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dhat", ",", "_Real", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ahat", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"bhat", ",", "_Real", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Chi]", ",", "_Real", ",", "1"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"allChangesGuessMod", "=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "iterVbar", ",", "iterLM", ",", "iterLR", ",", "iterQ", ",", 
          "iter\[Pi]ni", ",", "iterP", ",", "iter\[Lambda]tilde", ",", 
          "iterWtilde", ",", "distWages", ",", "dist\[Lambda]", ",", "wout", 
          ",", "\[Lambda]out", ",", "diag", ",", "\[IndentingNewLine]", 
          "temp1", ",", "temp2", ",", "temp3", ",", "temp4", ",", "temp5", 
          ",", "temp6", ",", "denRes", ",", "numRes", ",", "den", ",", "num", 
          ",", "den2", ",", "temp7", ",", "temp8", ",", "outcome"}], "}"}], 
        ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"vbar", " ", "hat"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"temp1", "=", "  ", 
          FractionBox[
           RowBox[{"\[Lambda]", " ", "bhat"}], 
           SuperscriptBox["khat", "\[Epsilon]"]]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"denRes", "=", 
          RowBox[{"temp1", ".", 
           SuperscriptBox["inWhat", "\[Epsilon]"]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"numRes", "=", 
          RowBox[{"temp1", ".", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["inWhat", 
              RowBox[{"\[Epsilon]", "+", "1"}]], " ", "workplaceWage"}], 
            ")"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"iterVbar", "=", 
          FractionBox["numRes", 
           RowBox[{"resWage", " ", "denRes"}]]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"lm", " ", "hat", " ", "and", " ", "lr", " ", "hat"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"note", ":", " ", 
            RowBox[{"\[Lambda]", " ", "are", " ", "already", " ", "flows"}]}],
            ",", " ", 
           RowBox[{
            RowBox[{"i", ".", "e", ".", " ", "shares"}], " ", "times", " ", 
            "Lbar", " ", "in", " ", "the", " ", "equations"}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"temp1", "=", 
          RowBox[{"\[Lambda]", " ", "in\[Lambda]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"iterLM", "=", 
          FractionBox[
           RowBox[{"Total", "[", "temp1", "]"}], "workplaceEmp"]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"iterLR", "=", 
          FractionBox[
           RowBox[{"Total", "[", 
            RowBox[{"Transpose", "[", "temp1", "]"}], "]"}], "resEmp"]}], ";",
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"q", " ", "hat"}], "*)"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"iterQ", "=", 
          SuperscriptBox[
           RowBox[{"(", 
            FractionBox[
             RowBox[{
              RowBox[{"resIncome", " ", "iterVbar", " ", "iterLR"}], "+", 
              "deficit"}], 
             RowBox[{"resIncome", "+", "deficit"}]], " ", ")"}], 
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{"1", "+", "\[Chi]"}], ")"}]}]]}], ";", "  ", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"\[Pi]ni", " ", "hat"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"temp1", "=", 
          RowBox[{"\[Pi]niOnlyTrading", " ", 
           SuperscriptBox["dhat", 
            RowBox[{"(", 
             RowBox[{"1", "-", "\[Sigma]"}], ")"}]]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"temp2", "=", 
          RowBox[{"iterLM", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             FractionBox["inWhat", "ahat"], ")"}], 
            RowBox[{"1", "-", "\[Sigma]"}]]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"den", "=", 
          RowBox[{"temp2", ".", "temp1"}]}], ";", " ", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"note", " ", "that", " ", "left"}], "-", 
           RowBox[{
           "product", " ", "effectively", " ", "gives", " ", "the", " ", 
            "transpose", " ", "of", " ", "temp1", " ", "times", " ", 
            RowBox[{"temp2", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"num", "=", 
          RowBox[{
           SuperscriptBox["dhat", 
            RowBox[{"(", 
             RowBox[{"1", "-", "\[Sigma]"}], ")"}]], " ", "temp2"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"iter\[Pi]ni", "=", 
          RowBox[{"Transpose", "[", 
           FractionBox[
            RowBox[{"Transpose", "[", "num", "]"}], "den"], "  ", "]"}]}], 
         " ", ";", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "the", " ", "term", " ", "inside", " ", "divides", " ", "each", 
            " ", "column", " ", "by", " ", "the", " ", "correspondent", " ", 
            "element", " ", "of", " ", "the", " ", "denominator"}], ";", " ", 
           RowBox[{
           "it", " ", "then", " ", "brings", " ", "the", " ", "matrix", " ", 
            "in", " ", "the", " ", "original", " ", "form"}]}], "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"P", " ", "hat"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"diag", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"iter\[Pi]ni", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "ncounties"}], "}"}]}], "]"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"iterP", "=", 
          RowBox[{
           FractionBox["inWhat", "ahat"], 
           SuperscriptBox[
            RowBox[{"(", 
             FractionBox["iterLM", "diag"], ")"}], 
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Sigma]"}], ")"}]}]]}]}], "  ", ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"w", " ", "hat"}], ",", " ", 
           RowBox[{"next", " ", "iteration"}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"temp1", "=", 
          RowBox[{"\[Pi]niOnlyTrading", " ", "iter\[Pi]ni"}]}], ";", 
         "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
         RowBox[{"temp4", "=", 
          RowBox[{
           RowBox[{"iterVbar", " ", "iterLR", "  ", "resIncome"}], "+", 
           "deficit"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"iterWtilde", "=", 
          FractionBox[
           RowBox[{"temp1", ".", "temp4"}], 
           RowBox[{"laborIncome", " ", "iterLM"}]]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"iterWtilde", "=", 
          FractionBox["iterWtilde", 
           RowBox[{"Mean", "[", "iterWtilde", "]"}]]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"\[Lambda]", " ", "hat"}], ",", " ", 
           RowBox[{"next", " ", "iteration"}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"temp7", "=", 
          RowBox[{
           SuperscriptBox["iterP", 
            RowBox[{"-", "\[Alpha]"}]], " ", 
           SuperscriptBox["iterQ", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "\[Alpha]"}]]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"temp6", "=", 
          RowBox[{"bhat", " ", 
           FractionBox[
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"Outer", "[", 
               RowBox[{"Times", ",", "temp7", ",", "inWhat"}], "]"}], ")"}], 
             "\[Epsilon]"], 
            SuperscriptBox["khat", "\[Epsilon]"]]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"den2", "=", 
          RowBox[{"Total", "[", 
           RowBox[{"Total", "[", 
            RowBox[{"\[Lambda]", " ", "temp6"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"iter\[Lambda]tilde", "=", 
          FractionBox[
           RowBox[{"(", 
            RowBox[{"temp6", " ", "population"}], ")"}], "den2"]}], " ", ";", 
         " ", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
             "to", " ", "limit", " ", "accumulation", " ", "of", " ", 
              "numerical", " ", "errors"}], " ", "-", " ", 
             RowBox[{
             "unconditional", " ", "shares", " ", "of", " ", "commuting", " ",
               "\[IndentingNewLine]", "have", " ", "a", " ", "very", " ", 
              "small", " ", "order", " ", "of", " ", "magnitude"}], " ", "-", 
             " ", 
             RowBox[{
             "we", " ", "predict", " ", "new", " ", "commuting", " ", "flows",
               " ", "in", " ", "#", " ", "of", " ", "jobs"}]}], ";", " ", 
            "hence"}], ",", " ", 
           RowBox[{
            RowBox[{
            "the", " ", "numerator", " ", "is", " ", "multiplied", " ", "by", 
             " ", "the", " ", "population", " ", "level", " ", "before", " ", 
             "dividing", " ", "it", " ", "for", " ", "the", " ", "sum", 
             "\[IndentingNewLine]", "of", " ", "all", " ", "terms", " ", "at",
              " ", "the", " ", "denominator"}], ";", " ", 
            RowBox[{
            "note", " ", "that", " ", "the", " ", "denominator", " ", 
             "contains", " ", "\[Lambda]"}]}], ",", " ", 
           RowBox[{
           "which", " ", "is", " ", "in", " ", "fact", " ", "flows", " ", 
            "of", " ", "jobs"}], ",", " ", 
           RowBox[{"rather", " ", "than", " ", "shares"}]}], "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"output", ":", " ", 
            RowBox[{
             RowBox[{"matrix", " ", "with", " ", "ncounties"}], "+", 
             RowBox[{"1", " ", "rows"}]}]}], ",", " ", 
           RowBox[{"and", " ", "ncounties", " ", "columns", " ", 
            RowBox[{"(", 
             RowBox[{
             "iterWtilde", " ", "is", " ", "added", " ", "as", " ", "a", " ", 
              "last", " ", "row"}], ")"}]}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"outcome", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"iter\[Lambda]tilde", ",", 
            RowBox[{"{", "iterWtilde", "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "outcome"}]}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[124]:=",ExpressionUUID->"dca763c1-b804-ce48-bead-3dfddfc5f702"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"beaCfsCorr", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "123"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"beaCfsIndex", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"beaCfsCorr", "[", 
         RowBox[{"[", " ", 
          RowBox[{"beaCfs", "[", 
           RowBox[{"[", 
            RowBox[{"n", ",", "1"}], "]"}], "]"}], " ", "]"}], "]"}], "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"beaCfsCorr", "[", 
           RowBox[{"[", " ", 
            RowBox[{"beaCfs", "[", 
             RowBox[{"[", 
              RowBox[{"n", ",", "1"}], "]"}], "]"}], " ", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"beaCfs", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", "2"}], "]"}], "]"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"beaCfsIndex", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"beaCfsIndex", ",", 
          RowBox[{"{", 
           RowBox[{"Length", "[", 
            RowBox[{"beaCfsCorr", "[", 
             RowBox[{"[", " ", 
              RowBox[{"beaCfs", "[", 
               RowBox[{"[", 
                RowBox[{"n", ",", "1"}], "]"}], "]"}], " ", "]"}], "]"}], 
            "]"}], "}"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "1", ",", "ncounties"}], "}"}]}], "]"}], 
  ";"}]}], "Input",
 CellLabel->
  "In[125]:=",ExpressionUUID->"a22d5c39-cfae-0142-a93d-beea3796d376"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"beaCfsCorr", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "123"}], "}"}]}], "]"}], "]"}]], "Input",
 CellLabel->
  "In[128]:=",ExpressionUUID->"3b720b1a-c79a-f441-a962-1068c0fa3dac"],

Cell[BoxData["3111"], "Output",
 CellChangeTimes->{3.9465727210742397`*^9},
 CellLabel->
  "Out[128]=",ExpressionUUID->"53f4242b-f31b-6846-a899-78bd8d51aaae"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cfsData", "=", 
   RowBox[{
   "Import", "[", "\"\<simulation inputs\\\\bilateral_cfs_trade.csv\>\"", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "cfsData", "]"}]}], "Input",
 CellLabel->
  "In[129]:=",ExpressionUUID->"8d1df9c3-060b-064a-9174-73f275edb1b2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"123", ",", "123"}], "}"}]], "Output",
 CellChangeTimes->{3.9465727255476856`*^9},
 CellLabel->
  "Out[130]=",ExpressionUUID->"0c8552ea-706d-244c-b3d0-05c74d709cb0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"defExpenditure", "=", 
   FractionBox[
    RowBox[{
     RowBox[{"Total", "[", "cfsData", "]"}], "-", 
     RowBox[{"Total", "[", 
      RowBox[{"cfsData", ",", 
       RowBox[{"{", "2", "}"}]}], "]"}]}], 
    RowBox[{"Total", "[", "cfsData", "]"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Histogram", "[", 
  RowBox[{"defExpenditure", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Min", "[", "defExpenditure", "]"}], ",", 
     RowBox[{"Quantile", "[", 
      RowBox[{"defExpenditure", ",", "0.999"}], "]"}], ",", 
     FractionBox[
      RowBox[{"Quantile", "[", 
       RowBox[{"defExpenditure", ",", "0.999"}], "]"}], "10"]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
   "PlotLabel", "\[Rule]", 
    "\"\<Distribution of CFS deficits as share of total expenditure\>\""}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Mean: \>\"", ",", 
    RowBox[{"Round", "[", 
     RowBox[{
      RowBox[{"Mean", "[", "defExpenditure", "]"}], ",", "0.001"}], "]"}], 
    ",", "\"\<; Min: \>\"", ",", 
    RowBox[{"Round", "[", 
     RowBox[{
      RowBox[{"Min", "[", "defExpenditure", "]"}], ",", "0.001"}], "]"}], 
    ",", "\"\<; Max: \>\"", ",", 
    RowBox[{"Round", "[", 
     RowBox[{
      RowBox[{"Max", "[", "defExpenditure", "]"}], ",", "0.001"}], "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"\"\<quantile\>\"", ",", "\"\<CFS deficit\>\""}], "}"}], "}"}], 
    ",", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"Quantile", "[", 
         RowBox[{
          RowBox[{"Round", "[", 
           RowBox[{"defExpenditure", ",", "0.001"}], "]"}], ",", "q"}], 
         "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"{", 
         RowBox[{
         "0.01", ",", "0.05", ",", "0.10", ",", "0.50", ",", "0.90", ",", 
          "0.95", ",", "0.99"}], "}"}]}], "}"}]}], "]"}]}], "]"}], "//", 
  "TableForm"}], "\[IndentingNewLine]"}], "Input",
 CellLabel->
  "In[131]:=",ExpressionUUID->"082bc60a-a908-b54e-9b26-206d9505523a"],

Cell[BoxData[
 GraphicsBox[{
   {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
    Opacity[0.5319999999999999], Thickness[Small]}], {}, 
    {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
     Opacity[0.5319999999999999], Thickness[Small]}], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{-1.1450712957222566`, 0}, {-1.0498392021238547`, 1.},
             "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{20.490378774577238`, 36.0297682168966}, {
           92.01178915535195, 101.12468361535548`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 1]& ,
        TagBoxNote->"1"],
       StyleBox["1", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[1, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{-1.0498392021238547`, 0}, {-0.9546071085254527, 1.}, 
            "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{35.5297682168966, 51.06915765921599}, {
           92.01178915535195, 101.12468361535548`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 1]& ,
        TagBoxNote->"1"],
       StyleBox["1", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[1, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{-0.5736787341318448, 0}, {-0.4784466405334428, 2.}, 
            "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{110.72671542849348`, 126.26610487081284`}, {
           83.39889469534843, 101.12468361535548`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 2]& ,
        TagBoxNote->"2"],
       StyleBox["2", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[2, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{-0.4784466405334428, 0}, {-0.3832145469350408, 3.}, 
            "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{125.76610487081284`, 141.30549431313221`}, {
           74.7860002353449, 101.12468361535548`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 3]& ,
        TagBoxNote->"3"],
       StyleBox["3", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[3, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{-0.3832145469350408, 0}, {-0.28798245333663886`, 4.},
             "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{140.80549431313221`, 156.34488375545158`}, {
           66.17310577534138, 101.12468361535548`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 4]& ,
        TagBoxNote->"4"],
       StyleBox["4", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[4, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{-0.28798245333663886`, 0}, {-0.19275035973823687`, 
            7.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{155.84488375545158`, 171.38427319777097`}, {
           40.3344223953308, 101.12468361535548`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 7]& ,
        TagBoxNote->"7"],
       StyleBox["7", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[7, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{-0.19275035973823687`, 0}, {-0.0975182661398349, 
            17.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{170.88427319777097`, 
           186.42366264009033`}, {-45.794522204704464`, 101.12468361535548`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 17]& ,
        TagBoxNote->"17"],
       StyleBox["17", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[17, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{-0.0975182661398349, 0}, {-0.0022861725414329227`, 
            20.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{185.92366264009033`, 
           201.46305208240972`}, {-71.63320558471503, 101.12468361535548`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 20]& ,
        TagBoxNote->"20"],
       StyleBox["20", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[20, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{-0.0022861725414329227`, 0}, {0.09294592105696906, 
            23.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{200.96305208240972`, 
           216.50244152472908`}, {-97.47188896472562, 101.12468361535548`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 23]& ,
        TagBoxNote->"23"],
       StyleBox["23", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[23, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{0.09294592105696906, 0}, {0.18817801465537104`, 16.},
             "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{216.00244152472908`, 
           231.54183096704847`}, {-37.18162774470093, 101.12468361535548`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 16]& ,
        TagBoxNote->"16"],
       StyleBox["16", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[16, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{0.18817801465537104`, 0}, {0.283410108253773, 5.}, 
            "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{231.04183096704847`, 246.58122040936783`}, {
           57.56021131533785, 101.12468361535548`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 5]& ,
        TagBoxNote->"5"],
       StyleBox["5", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[5, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{0.283410108253773, 0}, {0.378642201852175, 10.}, 
            "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{246.08122040936783`, 261.6206098516872}, {
           14.495739015320225`, 101.12468361535548`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 10]& ,
        TagBoxNote->"10"],
       StyleBox["10", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[10, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{0.378642201852175, 0}, {0.47387429545057697`, 6.}, 
            "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{261.1206098516872, 276.6599992940066}, {
           48.94731685533432, 101.12468361535548`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 6]& ,
        TagBoxNote->"6"],
       StyleBox["6", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[6, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{0.47387429545057697`, 0}, {0.5691063890489789, 3.}, 
            "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{276.1599992940066, 291.69938873632594`}, {
           74.7860002353449, 101.12468361535548`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 3]& ,
        TagBoxNote->"3"],
       StyleBox["3", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[3, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{0.5691063890489789, 0}, {0.6643384826473809, 3.}, 
            "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{291.19938873632594`, 306.73877817864536`}, {
           74.7860002353449, 101.12468361535548`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 3]& ,
        TagBoxNote->"3"],
       StyleBox["3", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[3, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{0.6643384826473809, 0}, {0.759570576245783, 1.}, 
            "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{306.23877817864536`, 321.7781676209647}, {
           92.01178915535195, 101.12468361535548`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 1]& ,
        TagBoxNote->"1"],
       StyleBox["1", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[1, {}], 
       "Tooltip"]& ]}, {}, {}}, {{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, \
{}, {}, {}, {}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{-1.1869734169055535`, 0},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{CoordinatesToolOptions -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}, "AxisPadding" -> Scaled[0.02], "ChartDefaultStyle" -> {
      RGBColor[0.97858, 0.678934, 0.157834], 
      RGBColor[0.368417, 0.506779, 0.709798], 
      RGBColor[0.560181, 0.691569, 0.194885], 
      RGBColor[0.922526, 0.385626, 0.209179], 
      RGBColor[0.528488, 0.470624, 0.701351], 
      RGBColor[0.772079, 0.431554, 0.102387], 
      RGBColor[0.363898, 0.618501, 0.782349], 
      RGBColor[1, 0.75, 0], 
      RGBColor[0.647624, 0.37816, 0.614037], 
      RGBColor[0.571589, 0.586483, 0.], 
      RGBColor[0.915, 0.3325, 0.2125], 
      RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
      RGBColor[0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
      RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
      RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965]}, 
    "DefaultBoundaryStyle" -> Automatic, "DefaultChartBaseStyle" -> 
    RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultPlotStyle" -> 
    Automatic, "DomainPadding" -> Scaled[0.02], "RangePadding" -> 
    Scaled[0.05]},
  PlotLabel->FormBox[
   "\"Distribution of CFS deficits as share of total expenditure\"", 
    TraditionalForm],
  PlotRange->{{-1.1450712957222566`, 0.9500347634425869}, {All, All}},
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.9465727308723297`*^9},
 CellLabel->
  "Out[132]=",ExpressionUUID->"66cbc147-bbdf-b541-9491-1de0e46d559c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Mean: \"\>", "\[InvisibleSpace]", "0.033`", 
   "\[InvisibleSpace]", "\<\"; Min: \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "1.145`"}], "\[InvisibleSpace]", "\<\"; Max: \"\>", 
   "\[InvisibleSpace]", "0.9520000000000001`"}],
  SequenceForm[
  "Mean: ", 0.033, "; Min: ", -1.145, "; Max: ", 0.9520000000000001],
  Editable->False]], "Print",
 CellChangeTimes->{3.946572730888157*^9},
 CellLabel->
  "During evaluation of \
In[131]:=",ExpressionUUID->"002fa1d0-9d9e-8b47-83dc-a4050dedb52e"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"quantile\"\>", "\<\"CFS deficit\"\>"},
    {"0.01`", 
     RowBox[{"-", "0.984`"}]},
    {"0.05`", 
     RowBox[{"-", "0.395`"}]},
    {"0.1`", 
     RowBox[{"-", "0.275`"}]},
    {"0.5`", "0.019`"},
    {"0.9`", "0.395`"},
    {"0.95`", "0.47800000000000004`"},
    {"0.99`", "0.737`"}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.9465727308974247`*^9},
 CellLabel->
  "Out[134]//TableForm=",ExpressionUUID->"5ee9e362-4b1c-7a41-a12e-\
1a2db69fed7b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cfsLabExp", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "123"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"cfsLabExp", "[", 
      RowBox[{"[", "k", "]"}], "]"}], "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"laborIncome", "[", 
        RowBox[{"[", "j", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"beaCfsCorr", "[", 
          RowBox[{"[", "k", "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"k", ",", "1", ",", "123"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cfsLabExp", "=", 
   RowBox[{"Total", "[", 
    RowBox[{"cfsLabExp", ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Total", "[", "cfsLabExp", "]"}], "-", 
  RowBox[{"Total", "[", "laborIncome", "]"}]}]}], "Input",
 CellLabel->
  "In[135]:=",ExpressionUUID->"e2cebad6-257a-e140-b46d-1427fed2fa8c"],

Cell[BoxData["1.862645149230957`*^-9"], "Output",
 CellChangeTimes->{3.9465727377967434`*^9},
 CellLabel->
  "Out[138]=",ExpressionUUID->"6f7e6bd7-d07a-3f47-9e75-f78f5ab91a73"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"rescaledCfs", "=", 
   RowBox[{
    FractionBox["cfsData", 
     RowBox[{"Total", "[", 
      RowBox[{"cfsData", ",", 
       RowBox[{"{", "2", "}"}]}], "]"}]], "  ", "cfsLabExp"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[139]:=",ExpressionUUID->"b62a69af-acf9-d049-bacd-c8b25f28a568"],

Cell[BoxData[
 RowBox[{
  RowBox[{"cfsDeficit", "=", 
   RowBox[{
    RowBox[{"Total", "[", "rescaledCfs", "]"}], "-", 
    RowBox[{"Total", "[", 
     RowBox[{"rescaledCfs", ",", 
      RowBox[{"{", "2", "}"}]}], "]"}]}]}], ";"}]], "Input",
 CellLabel->
  "In[140]:=",ExpressionUUID->"7cb86c3c-bd0b-2649-93b9-dad6674693b1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cfsResIncome", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "123"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"cfsResIncome", "[", 
      RowBox[{"[", "k", "]"}], "]"}], "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"resIncome", "[", 
        RowBox[{"[", "j", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"beaCfsCorr", "[", 
          RowBox[{"[", "k", "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"k", ",", "1", ",", "123"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"increments", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"cfsResIncome", "[", 
        RowBox[{"[", "k", "]"}], "]"}], 
       RowBox[{"Total", "[", 
        RowBox[{"cfsResIncome", "[", 
         RowBox[{"[", "k", "]"}], "]"}], "]"}]], 
      RowBox[{"cfsDeficit", "[", 
       RowBox[{"[", "k", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "123"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"resExpenditure", "=", "resIncome"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"resExpenditure", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"resExpenditure", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "+", " ", 
      RowBox[{"increments", "[", 
       RowBox[{"[", " ", 
        RowBox[{
         RowBox[{"beaCfs", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"beaCfsIndex", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], " ", "]"}], "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "ncounties"}], "}"}]}], "]"}], 
  ";"}]}], "Input",
 CellLabel->
  "In[141]:=",ExpressionUUID->"3f3583e4-99ca-bd4f-9b5c-d573c3a2253c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"countyDeficit", "=", 
    RowBox[{
     FractionBox["resExpenditure", "resIncome"], "-", "1"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Histogram", "[", 
  RowBox[{"countyDeficit", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Min", "[", "countyDeficit", "]"}], ",", 
     RowBox[{"Quantile", "[", 
      RowBox[{"countyDeficit", ",", "0.999"}], "]"}], ",", 
     FractionBox[
      RowBox[{"Quantile", "[", 
       RowBox[{"countyDeficit", ",", "0.999"}], "]"}], "10"]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
   "PlotLabel", "\[Rule]", 
    "\"\<Distribution of county deficits as share of residential \
income\>\""}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Mean: \>\"", ",", 
    RowBox[{"Round", "[", 
     RowBox[{
      RowBox[{"Mean", "[", "countyDeficit", "]"}], ",", "0.001"}], "]"}], 
    ",", "\"\<; Min: \>\"", ",", 
    RowBox[{"Round", "[", 
     RowBox[{
      RowBox[{"Min", "[", "countyDeficit", "]"}], ",", "0.001"}], "]"}], ",", 
    "\"\<; Max: \>\"", ",", 
    RowBox[{"Round", "[", 
     RowBox[{
      RowBox[{"Max", "[", "countyDeficit", "]"}], ",", "0.001"}], "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"\"\<quantile\>\"", ",", "\"\<county deficit\>\""}], "}"}], 
     "}"}], ",", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"Quantile", "[", 
         RowBox[{
          RowBox[{"Round", "[", 
           RowBox[{"countyDeficit", ",", "0.001"}], "]"}], ",", "q"}], 
         "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"{", 
         RowBox[{
         "0.01", ",", "0.05", ",", "0.10", ",", "0.50", ",", "0.90", ",", 
          "0.95", ",", "0.99"}], "}"}]}], "}"}]}], "]"}]}], "]"}], "//", 
  "TableForm"}]}], "Input",
 CellLabel->
  "In[146]:=",ExpressionUUID->"200c811e-0c21-ba49-823c-58a4dd9c7cec"],

Cell[BoxData[
 GraphicsBox[{
   {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
    Opacity[0.588], Thickness[Small]}], {}, 
    {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
     Opacity[0.588], Thickness[Small]}], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{-0.4179546052941546, 0}, {-0.3311488271675456, 1.}, 
            "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{25.937500496775257`, 49.6622482354899}, {
           98.59493590897826, 99.32025052961909}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 1]& ,
        TagBoxNote->"1"],
       StyleBox["1", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[1, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{-0.3311488271675456, 0}, {-0.2443430490409366, 61.}, 
            "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{49.1622482354899, 72.88699597420454}, {
           85.07605867052801, 99.32025052961909}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 61]& ,
        TagBoxNote->"61"],
       StyleBox["61", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[61, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{-0.2443430490409366, 0}, {-0.15753727091432757`, 
            155.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{72.38699597420454, 96.11174371291918}, {
           63.8964843302893, 99.32025052961909}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 155]& ,
        TagBoxNote->"155"],
       StyleBox["155", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[155, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{-0.15753727091432757`, 0}, {-0.07073149278771856, 
            196.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{95.61174371291918, 119.33649145163382`}, {
           54.658584884014964`, 99.32025052961909}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 196]& ,
        TagBoxNote->"196"],
       StyleBox["196", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[196, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{-0.07073149278771856, 0}, {0.016074285338890437`, 
            498.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{118.83649145163382`, 
           142.56123919034846`}, {-13.386430549517925`, 99.32025052961909}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 498]& ,
        TagBoxNote->"498"],
       StyleBox["498", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[498, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{0.016074285338890437`, 0}, {0.1028800634654995, 
            864.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{142.06123919034846`, 
           165.7859869290631}, {-95.8515817040644, 99.32025052961909}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 864]& ,
        TagBoxNote->"864"],
       StyleBox["864", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[864, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{0.1028800634654995, 0}, {0.18968584159210844`, 453.},
             "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{165.2859869290631, 
           189.01073466777774`}, {-3.247272620680249, 99.32025052961909}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 453]& ,
        TagBoxNote->"453"],
       StyleBox["453", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[453, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{0.18968584159210844`, 0}, {0.2764916197187175, 471.},
             "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{188.51073466777774`, 
           212.2354824064924}, {-7.302935792215322, 99.32025052961909}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 471]& ,
        TagBoxNote->"471"],
       StyleBox["471", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[471, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{0.2764916197187175, 0}, {0.36329739784532655`, 331.},
             "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{211.7354824064924, 235.46023014520702`}, {
           24.241111097501914`, 99.32025052961909}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 331]& ,
        TagBoxNote->"331"],
       StyleBox["331", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[331, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{0.36329739784532655`, 0}, {0.4501031759719355, 56.}, 
            "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{234.96023014520702`, 258.68497788392165`}, {
           86.2026317737322, 99.32025052961909}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 56]& ,
        TagBoxNote->"56"],
       StyleBox["56", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[56, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{0.4501031759719355, 0}, {0.5369089540985446, 1.}, 
            "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{258.18497788392165`, 281.9097256226363}, {
           98.59493590897826, 99.32025052961909}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 1]& ,
        TagBoxNote->"1"],
       StyleBox["1", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[1, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{0.5369089540985446, 0}, {0.6237147322251536, 8.}, 
            "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{281.4097256226363, 305.13447336135096`}, {
           97.01773356449239, 99.32025052961909}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 8]& ,
        TagBoxNote->"8"],
       StyleBox["8", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[8, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{0.7105205103517626, 0}, {0.7973262884783715, 12.}, 
            "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{327.85922110006555`, 351.58396883878015`}, {
           96.11647508192904, 99.32025052961909}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 12]& ,
        TagBoxNote->"12"],
       StyleBox["12", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[12, {}], 
       "Tooltip"]& ]}, {}, {}}, {{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, \
{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{-0.44226022316960517`, 0},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{CoordinatesToolOptions -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}, "AxisPadding" -> Scaled[0.02], "ChartDefaultStyle" -> {
      RGBColor[0.97858, 0.678934, 0.157834], 
      RGBColor[0.368417, 0.506779, 0.709798], 
      RGBColor[0.560181, 0.691569, 0.194885], 
      RGBColor[0.922526, 0.385626, 0.209179], 
      RGBColor[0.528488, 0.470624, 0.701351], 
      RGBColor[0.772079, 0.431554, 0.102387], 
      RGBColor[0.363898, 0.618501, 0.782349], 
      RGBColor[1, 0.75, 0], 
      RGBColor[0.647624, 0.37816, 0.614037], 
      RGBColor[0.571589, 0.586483, 0.], 
      RGBColor[0.915, 0.3325, 0.2125], 
      RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
      RGBColor[0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
      RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
      RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965]}, 
    "DefaultBoundaryStyle" -> Automatic, "DefaultChartBaseStyle" -> 
    RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultPlotStyle" -> 
    Automatic, "DomainPadding" -> Scaled[0.02], "RangePadding" -> 
    Scaled[0.05]},
  PlotLabel->FormBox[
   "\"Distribution of county deficits as share of residential income\"", 
    TraditionalForm],
  PlotRange->{{-0.4179546052941546, 0.7973262884783715}, {All, All}},
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.9465727644404316`*^9},
 CellLabel->
  "Out[147]=",ExpressionUUID->"b4a4559a-0954-f246-96a9-048cd1ff0fa0"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Mean: \"\>", "\[InvisibleSpace]", "0.092`", 
   "\[InvisibleSpace]", "\<\"; Min: \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "0.418`"}], "\[InvisibleSpace]", "\<\"; Max: \"\>", 
   "\[InvisibleSpace]", "7.1000000000000005`"}],
  SequenceForm[
  "Mean: ", 0.092, "; Min: ", -0.418, "; Max: ", 7.1000000000000005`],
  Editable->False]], "Print",
 CellChangeTimes->{3.9465727644608727`*^9},
 CellLabel->
  "During evaluation of \
In[146]:=",ExpressionUUID->"9acb6d5a-cd2a-c74b-bf52-b4fa95d10234"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"quantile\"\>", "\<\"county deficit\"\>"},
    {"0.01`", 
     RowBox[{"-", "0.273`"}]},
    {"0.05`", 
     RowBox[{"-", "0.223`"}]},
    {"0.1`", 
     RowBox[{"-", "0.098`"}]},
    {"0.5`", "0.076`"},
    {"0.9`", "0.28`"},
    {"0.95`", "0.28200000000000003`"},
    {"0.99`", "0.368`"}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.9465727644608727`*^9},
 CellLabel->
  "Out[149]//TableForm=",ExpressionUUID->"74a88abe-7077-f047-a0ee-\
8ba6b192becc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"QuantilePlot", "[", 
    RowBox[{"defExpenditure", ",", "countyDeficit", ",", 
     RowBox[{"ReferenceLineStyle", "\[Rule]", "Red"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<County deficit quantiles\>\"", ",", 
        "\"\<CFS deficit quantiles\>\""}], "}"}]}], ",", 
     RowBox[{
     "PlotLabel", "\[Rule]", "\"\<Q-Q plot of county vs cfs deficits\>\""}], 
     ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1.2"}], ",", "1.2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1.2"}], ",", "1.2"}], "}"}]}], "}"}]}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"ParametricPlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "x"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "1.2"}], ",", "1.2"}], "}"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", "Dashed", ",", "Thin"}], "]"}]}]}], "]"}]}], 
  "]"}]], "Input",
 CellLabel->
  "In[150]:=",ExpressionUUID->"fd57cd7a-2820-5f40-b99d-6f99ca0d9076"],

Cell[BoxData[
 GraphicsBox[{{{}, 
    InterpretationBox[{
      TagBox[{
        TagBox[
         {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
          0.009166666666666668], AbsoluteThickness[2], 
          PointBox[CompressedData["
1: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
tRU5sqWjEPdZoNj/3DT8CUxxDOU=
           "]]},
         Annotation[#, "Charting`Private`Tag#1"]& ], 
        TagBox[
         TagBox[
          {Opacity[0], 
           PointBox[{{-1.3010416666666667`, -1.9211095238631835`}, {
            1.2510416666666664`, 1.619623554041462}}]},
          Annotation[#, <||>, "NoShowDynamicHighlight"]& ],
         Annotation[#, "Charting`Private`Tag#2"]& ]},
       {"WolframDynamicHighlight", <|
        "Label" -> {"XYLabel"}, "Ball" -> {"IndicatedBall"}|>}], 
      StyleBox[
       DynamicBox[(Charting`HighlightActionBox["DynamicHighlight", {}, 
         Slot["HighlightElements"], 
         Slot["LayoutOptions"], 
         Slot["Meta"], 
         Charting`HighlightActionFunction["DynamicHighlight", {{
            Annotation[{
              Directive[
               PointSize[0.009166666666666668], 
               RGBColor[0.368417, 0.506779, 0.709798], 
               AbsoluteThickness[2]], 
              Point[CompressedData["
1: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
tRU5sqWjEPdZoNj/3DT8CUxxDOU=
               "]]}, "Charting`Private`Tag#1"], 
            Annotation[{
              Annotation[
               Style[{
                 
                 Point[{{-1.3010416666666667`, -1.9211095238631835`}, {
                  1.2510416666666664`, 1.619623554041462}}]}, {
                 Directive[
                  Opacity[0]]}], <||>, "NoShowDynamicHighlight"]}, 
             "Charting`Private`Tag#2"]}}, <|
          "HighlightElements" -> <|
            "Label" -> {"XYLabel"}, "Ball" -> {"IndicatedBall"}|>, 
           "LayoutOptions" -> <|
            "PanelPlotLayout" -> <||>, 
             "PlotRange" -> {{-1.2, 1.2}, {-1.2, 1.2}}, 
             "Frame" -> {{True, True}, {True, True}}, "AxesOrigin" -> {0, 0}, 
             "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {False, False}, 
             "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
             "DefaultStyle" -> {
               Directive[
                PointSize[0.009166666666666668], 
                RGBColor[0.368417, 0.506779, 0.709798], 
                AbsoluteThickness[2]]}, 
             "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
                 Identity[
                  Part[#, 1]], 
                 Identity[
                  Part[#, 2]]}& ), 
               "ScalingFunctions" -> {{Identity, Identity}, {
                 Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
             False|>, 
           "Meta" -> <|
            "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, 
             "Function" -> QuantilePlot, "GroupHighlight" -> False|>|>]]& )[<|
         "HighlightElements" -> <|
           "Label" -> {"XYLabel"}, "Ball" -> {"IndicatedBall"}|>, 
          "LayoutOptions" -> <|
           "PanelPlotLayout" -> <||>, 
            "PlotRange" -> {{-1.2, 1.2}, {-1.2, 1.2}}, 
            "Frame" -> {{True, True}, {True, True}}, "AxesOrigin" -> {0, 0}, 
            "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {False, False}, 
            "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
            "DefaultStyle" -> {
              Directive[
               PointSize[0.009166666666666668], 
               RGBColor[0.368417, 0.506779, 0.709798], 
               AbsoluteThickness[2]]}, 
            "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
                Identity[
                 Part[#, 1]], 
                Identity[
                 Part[#, 2]]}& ), 
              "ScalingFunctions" -> {{Identity, Identity}, {
                Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
            False|>, 
          "Meta" -> <|
           "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
            QuantilePlot, "GroupHighlight" -> False|>|>],
        ImageSizeCache->{{4.503599627370496*^15, -4.503599627370496*^15}, {
         4.503599627370496*^15, -4.503599627370496*^15}}],
       Selectable->False]},
     Annotation[{{
        Annotation[{
          Directive[
           PointSize[0.009166666666666668], 
           RGBColor[0.368417, 0.506779, 0.709798], 
           AbsoluteThickness[2]], 
          Point[CompressedData["
1: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
tRU5sqWjEPdZoNj/3DT8CUxxDOU=
           "]]}, "Charting`Private`Tag#1"], 
        Annotation[{
          Annotation[
           Style[{
             
             Point[{{-1.3010416666666667`, -1.9211095238631835`}, {
              1.2510416666666664`, 1.619623554041462}}]}, {
             Directive[
              Opacity[0]]}], <||>, "NoShowDynamicHighlight"]}, 
         "Charting`Private`Tag#2"]}}, <|
      "HighlightElements" -> <|
        "Label" -> {"XYLabel"}, "Ball" -> {"IndicatedBall"}|>, 
       "LayoutOptions" -> <|
        "PanelPlotLayout" -> <||>, "PlotRange" -> {{-1.2, 1.2}, {-1.2, 1.2}}, 
         "Frame" -> {{True, True}, {True, True}}, "AxesOrigin" -> {0, 0}, 
         "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {False, False}, 
         "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
         "DefaultStyle" -> {
           Directive[
            PointSize[0.009166666666666668], 
            RGBColor[0.368417, 0.506779, 0.709798], 
            AbsoluteThickness[2]]}, 
         "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
             Identity[
              Part[#, 1]], 
             Identity[
              Part[#, 2]]}& ), 
           "ScalingFunctions" -> {{Identity, Identity}, {
             Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> False|>, 
       "Meta" -> <|
        "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
         QuantilePlot, "GroupHighlight" -> False|>|>, 
      "DynamicHighlight"]], {{}, {}}}, 
   InterpretationBox[{
     TagBox[{{{}, {}, 
        TagBox[
         {GrayLevel[0], Thickness[Tiny], Opacity[1.], Dashing[{Small, Small}],
           FaceForm[Opacity[0.3]], LineBox[CompressedData["
1:eJxF1P0zE3AcB/B5rJV+yW43xkRGDzRbJ4VLmTvlqaRLmduy1CjKGaZn6lKb
0Nyt1dEUijpXMVYet67SnYbGNOnGmmg7edjkQvR4+Xzfd+973+sfeLuyT+07
aonBYCL/9O8uZfO/TMuXHIftY1J8kC8NZQk2eiO/y2/6tNYTOeXzzhs4InKl
aO/4jCUyfja16nmPGTzXUk3cno5MVcz9WnXPBBbmWEqbtFPgvC9d9EAS8oei
8bs2dybAMx01sREO48izbrbOmWNg14w1aeJ+I7g0uYD3NtYAno+uzeLLRsFV
9SH2FtQRcE4i64SbdBgcuIza3InTg0Pd06tpxTpwapLakT6oBVe49TIyqgbA
PNVTDaFaA7Y/thCs4qjBkZMexgWmClzScmExe4MSvLtbiS9reA3m3KwNj2XJ
wQxyrqdiTx3YiUhr1vBugZWNMplDnDhoyYURaXbSrjowjfBMvtrYBo73qIgT
WrWDzfmRHDNXCSZbO1+U+avAgnjyR9Y5NThaEbUgytOAX/CTH2TnDoCPp+IT
Qlu14IBN6Wmqwzqwlla+NdNKD/ZpZR9hCYbBB+dLesqwI+DSEFLYgYejYCGO
6h7jbQCXm67btquM4Gu5Cd5FJ8fALuJ2mWTyK7inMWOXu3AC7Fh7iJS9cgos
Yzb48zuQdcW+jL7bJrAe+7MmhGEGXx3EcyqZyF5Siqs1G5kXnyB6mYRs9+TV
+eAs5C3786N2CJEFEsJUwBtkCpf6qKQDWR0alvijE9nFdLa/SY1cTx9SbNMj
DxruC/0WkS+3toWLMdPgdcUam+9WyNwA7BnZCuTlhSlsXwLyY/YVJxEROcZP
8v4bCVmi6w6rJyPTGwzWuPXIBr6FnOuFXMh0PN1LQf7/X0G/AZFzQmE=
           "]]},
         Annotation[#, "Charting`Private`Tag#1"]& ], 
        TagBox[
         {GrayLevel[0], Thickness[Tiny], Opacity[1.], Dashing[{Small, Small}],
           FaceForm[Opacity[0.3]], LineBox[CompressedData["
1:eJxF1P0zE3AcB/B5rJV+yW43xkRGDzRbJ4XrwdwpTyVdytyWpUZRzjA9U5fa
1DR3a3U0haLOVYyVx62rdKehMU26sSbaTh42uRA9nj7f99373vf6B97u7JN7
j1hjMJioP/27G/9lSoFZTDy2l0nxQ744mC1Y74v8rqDx02pv5NTPO27giMgV
4j1j09bI+Jm0yufdFvBscxVxawYyVTn7a8U9M1iUay1r1E2C87900oNJyB8K
x+7a3RkHT7dXx0U6jSHPeNi7Zo2C3TNXpUv6TOCSlOu8t3FG8FxMTTZfPgKu
rAt1tKIOg3OTWMc9ZEPg4CXUpg6cARzmmVFFK9KD05I1zvQBHbjco4eRWdkP
5qmfaglVWrDj0fkQNUcDjprwMs0z1eDi5vMLOetU4F1dKnxp/Wsw52ZNRBxL
AWaQ87yVu2vBLkRak5Z3C6xqkMud4iXb/lsYme4g66wF0wjPFCtNreAEr/J4
kU0b2FIQxbFwVWCyresFeaAaLEggf2Sd1YBjlNHz4nwt+AU/5UFOXj/4WBo+
MaxFBw7akJGuPqQH62hlm7NsDGC/FvZhlmAIfGCuuLsUOwwuCSWF7384Ahbh
qJ6xvkZwmfmafZvaBL6al+hbeGIU7CZpk0snvoK7GzJ3eorGwc41B0k5yyfB
cmZ9IL8dWV/kz+i9bQYbsD+rQxkW8JUBPKeCiewjo7jbspF5CYnil8nIDk9e
nQvJRt60ryB6uwhZICVMBr1BpnCpj4rbkTVh4Uk/OpDdzGf6GjXIdfRB5RYD
8oDxvihgAflSS2uEBDMFXlOktftug8wNwp6WL0NeKkxl+xOQH7Mvu4iJyLEB
0vffSMhSfVd4HRmZXm+0xa1FNvKtFFwfZCHT+VQPBXnxv8C/AZTBQmE=
           "]]},
         Annotation[#, "Charting`Private`Tag#2"]& ]}, {}},
      {"WolframDynamicHighlight", <|
       "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>}], 
     StyleBox[
      DynamicBox[(Charting`HighlightActionBox["DynamicHighlight", {}, 
        Slot["HighlightElements"], 
        Slot["LayoutOptions"], 
        Slot["Meta"], 
        Charting`HighlightActionFunction["DynamicHighlight", {{{{}, {}, 
            Annotation[{
              Directive[
               Opacity[1.], 
               AbsoluteThickness[2], 
               FaceForm[
                Opacity[0.3]], 
               GrayLevel[0], 
               Dashing[{Small, Small}], 
               Thickness[Tiny]], 
              Line[CompressedData["
1:eJxF1P0zE3AcB/B5rJV+yW43xkRGDzRbJ4VLmTvlqaRLmduy1CjKGaZn6lKb
0Nyt1dEUijpXMVYet67SnYbGNOnGmmg7edjkQvR4+Xzfd+973+sfeLuyT+07
aonBYCL/9O8uZfO/TMuXHIftY1J8kC8NZQk2eiO/y2/6tNYTOeXzzhs4InKl
aO/4jCUyfja16nmPGTzXUk3cno5MVcz9WnXPBBbmWEqbtFPgvC9d9EAS8oei
8bs2dybAMx01sREO48izbrbOmWNg14w1aeJ+I7g0uYD3NtYAno+uzeLLRsFV
9SH2FtQRcE4i64SbdBgcuIza3InTg0Pd06tpxTpwapLakT6oBVe49TIyqgbA
PNVTDaFaA7Y/thCs4qjBkZMexgWmClzScmExe4MSvLtbiS9reA3m3KwNj2XJ
wQxyrqdiTx3YiUhr1vBugZWNMplDnDhoyYURaXbSrjowjfBMvtrYBo73qIgT
WrWDzfmRHDNXCSZbO1+U+avAgnjyR9Y5NThaEbUgytOAX/CTH2TnDoCPp+IT
Qlu14IBN6Wmqwzqwlla+NdNKD/ZpZR9hCYbBB+dLesqwI+DSEFLYgYejYCGO
6h7jbQCXm67btquM4Gu5Cd5FJ8fALuJ2mWTyK7inMWOXu3AC7Fh7iJS9cgos
Yzb48zuQdcW+jL7bJrAe+7MmhGEGXx3EcyqZyF5Siqs1G5kXnyB6mYRs9+TV
+eAs5C3786N2CJEFEsJUwBtkCpf6qKQDWR0alvijE9nFdLa/SY1cTx9SbNMj
DxruC/0WkS+3toWLMdPgdcUam+9WyNwA7BnZCuTlhSlsXwLyY/YVJxEROcZP
8v4bCVmi6w6rJyPTGwzWuPXIBr6FnOuFXMh0PN1LQf7/X0G/AZFzQmE=
               "]]}, "Charting`Private`Tag#1"], 
            Annotation[{
              Directive[
               Opacity[1.], 
               AbsoluteThickness[2], 
               FaceForm[
                Opacity[0.3]], 
               GrayLevel[0], 
               Dashing[{Small, Small}], 
               Thickness[Tiny]], 
              Line[CompressedData["
1:eJxF1P0zE3AcB/B5rJV+yW43xkRGDzRbJ4XrwdwpTyVdytyWpUZRzjA9U5fa
1DR3a3U0haLOVYyVx62rdKehMU26sSbaTh42uRA9nj7f99373vf6B97u7JN7
j1hjMJioP/27G/9lSoFZTDy2l0nxQ744mC1Y74v8rqDx02pv5NTPO27giMgV
4j1j09bI+Jm0yufdFvBscxVxawYyVTn7a8U9M1iUay1r1E2C87900oNJyB8K
x+7a3RkHT7dXx0U6jSHPeNi7Zo2C3TNXpUv6TOCSlOu8t3FG8FxMTTZfPgKu
rAt1tKIOg3OTWMc9ZEPg4CXUpg6cARzmmVFFK9KD05I1zvQBHbjco4eRWdkP
5qmfaglVWrDj0fkQNUcDjprwMs0z1eDi5vMLOetU4F1dKnxp/Wsw52ZNRBxL
AWaQ87yVu2vBLkRak5Z3C6xqkMud4iXb/lsYme4g66wF0wjPFCtNreAEr/J4
kU0b2FIQxbFwVWCyresFeaAaLEggf2Sd1YBjlNHz4nwt+AU/5UFOXj/4WBo+
MaxFBw7akJGuPqQH62hlm7NsDGC/FvZhlmAIfGCuuLsUOwwuCSWF7384Ahbh
qJ6xvkZwmfmafZvaBL6al+hbeGIU7CZpk0snvoK7GzJ3eorGwc41B0k5yyfB
cmZ9IL8dWV/kz+i9bQYbsD+rQxkW8JUBPKeCiewjo7jbspF5CYnil8nIDk9e
nQvJRt60ryB6uwhZICVMBr1BpnCpj4rbkTVh4Uk/OpDdzGf6GjXIdfRB5RYD
8oDxvihgAflSS2uEBDMFXlOktftug8wNwp6WL0NeKkxl+xOQH7Mvu4iJyLEB
0vffSMhSfVd4HRmZXm+0xa1FNvKtFFwfZCHT+VQPBXnxv8C/AZTBQmE=
               "]]}, "Charting`Private`Tag#2"]}}, {}}, <|
         "HighlightElements" -> <|
           "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
          "LayoutOptions" -> <|
           "PanelPlotLayout" -> <||>, 
            "PlotRange" -> {{-1.2, 1.2}, {-1.2, 1.2}}, 
            "Frame" -> {{False, False}, {False, False}}, 
            "AxesOrigin" -> {0, 0}, "ImageSize" -> {360, 432}, 
            "Axes" -> {True, True}, "LabelStyle" -> {}, "AspectRatio" -> 
            Automatic, "DefaultStyle" -> {
              Directive[
               Opacity[1.], 
               AbsoluteThickness[2], 
               FaceForm[
                Opacity[0.3]], 
               GrayLevel[0], 
               Dashing[{Small, Small}], 
               Thickness[Tiny]], 
              Directive[
               Opacity[1.], 
               AbsoluteThickness[2], 
               FaceForm[
                Opacity[0.3]], 
               GrayLevel[0], 
               Dashing[{Small, Small}], 
               Thickness[Tiny]]}, 
            "HighlightLabelingFunctions" -> <|
             "CoordinatesToolOptions" -> Identity, 
              "ScalingFunctions" -> {{Identity, Identity}, {
                Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
            False|>, 
          "Meta" -> <|
           "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
            ParametricPlot, "GroupHighlight" -> False|>|>]]& )[<|
        "HighlightElements" -> <|
          "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
         "LayoutOptions" -> <|
          "PanelPlotLayout" -> <||>, 
           "PlotRange" -> {{-1.2, 1.2}, {-1.2, 1.2}}, 
           "Frame" -> {{False, False}, {False, False}}, 
           "AxesOrigin" -> {0, 0}, "ImageSize" -> {360, 432}, 
           "Axes" -> {True, True}, "LabelStyle" -> {}, "AspectRatio" -> 
           Automatic, "DefaultStyle" -> {
             Directive[
              Opacity[1.], 
              AbsoluteThickness[2], 
              FaceForm[
               Opacity[0.3]], 
              GrayLevel[0], 
              Dashing[{Small, Small}], 
              Thickness[Tiny]], 
             Directive[
              Opacity[1.], 
              AbsoluteThickness[2], 
              FaceForm[
               Opacity[0.3]], 
              GrayLevel[0], 
              Dashing[{Small, Small}], 
              Thickness[Tiny]]}, 
           "HighlightLabelingFunctions" -> <|
            "CoordinatesToolOptions" -> Identity, 
             "ScalingFunctions" -> {{Identity, Identity}, {
               Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
           False|>, 
         "Meta" -> <|
          "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
           ParametricPlot, "GroupHighlight" -> False|>|>],
       ImageSizeCache->{{4.503599627370496*^15, -4.503599627370496*^15}, {
        4.503599627370496*^15, -4.503599627370496*^15}}],
      Selectable->False]},
    Annotation[{{{{}, {}, 
        Annotation[{
          Directive[
           Opacity[1.], 
           AbsoluteThickness[2], 
           FaceForm[
            Opacity[0.3]], 
           GrayLevel[0], 
           Dashing[{Small, Small}], 
           Thickness[Tiny]], 
          Line[CompressedData["
1:eJxF1P0zE3AcB/B5rJV+yW43xkRGDzRbJ4VLmTvlqaRLmduy1CjKGaZn6lKb
0Nyt1dEUijpXMVYet67SnYbGNOnGmmg7edjkQvR4+Xzfd+973+sfeLuyT+07
aonBYCL/9O8uZfO/TMuXHIftY1J8kC8NZQk2eiO/y2/6tNYTOeXzzhs4InKl
aO/4jCUyfja16nmPGTzXUk3cno5MVcz9WnXPBBbmWEqbtFPgvC9d9EAS8oei
8bs2dybAMx01sREO48izbrbOmWNg14w1aeJ+I7g0uYD3NtYAno+uzeLLRsFV
9SH2FtQRcE4i64SbdBgcuIza3InTg0Pd06tpxTpwapLakT6oBVe49TIyqgbA
PNVTDaFaA7Y/thCs4qjBkZMexgWmClzScmExe4MSvLtbiS9reA3m3KwNj2XJ
wQxyrqdiTx3YiUhr1vBugZWNMplDnDhoyYURaXbSrjowjfBMvtrYBo73qIgT
WrWDzfmRHDNXCSZbO1+U+avAgnjyR9Y5NThaEbUgytOAX/CTH2TnDoCPp+IT
Qlu14IBN6Wmqwzqwlla+NdNKD/ZpZR9hCYbBB+dLesqwI+DSEFLYgYejYCGO
6h7jbQCXm67btquM4Gu5Cd5FJ8fALuJ2mWTyK7inMWOXu3AC7Fh7iJS9cgos
Yzb48zuQdcW+jL7bJrAe+7MmhGEGXx3EcyqZyF5Siqs1G5kXnyB6mYRs9+TV
+eAs5C3786N2CJEFEsJUwBtkCpf6qKQDWR0alvijE9nFdLa/SY1cTx9SbNMj
DxruC/0WkS+3toWLMdPgdcUam+9WyNwA7BnZCuTlhSlsXwLyY/YVJxEROcZP
8v4bCVmi6w6rJyPTGwzWuPXIBr6FnOuFXMh0PN1LQf7/X0G/AZFzQmE=
           "]]}, "Charting`Private`Tag#1"], 
        Annotation[{
          Directive[
           Opacity[1.], 
           AbsoluteThickness[2], 
           FaceForm[
            Opacity[0.3]], 
           GrayLevel[0], 
           Dashing[{Small, Small}], 
           Thickness[Tiny]], 
          Line[CompressedData["
1:eJxF1P0zE3AcB/B5rJV+yW43xkRGDzRbJ4XrwdwpTyVdytyWpUZRzjA9U5fa
1DR3a3U0haLOVYyVx62rdKehMU26sSbaTh42uRA9nj7f99373vf6B97u7JN7
j1hjMJioP/27G/9lSoFZTDy2l0nxQ744mC1Y74v8rqDx02pv5NTPO27giMgV
4j1j09bI+Jm0yufdFvBscxVxawYyVTn7a8U9M1iUay1r1E2C87900oNJyB8K
x+7a3RkHT7dXx0U6jSHPeNi7Zo2C3TNXpUv6TOCSlOu8t3FG8FxMTTZfPgKu
rAt1tKIOg3OTWMc9ZEPg4CXUpg6cARzmmVFFK9KD05I1zvQBHbjco4eRWdkP
5qmfaglVWrDj0fkQNUcDjprwMs0z1eDi5vMLOetU4F1dKnxp/Wsw52ZNRBxL
AWaQ87yVu2vBLkRak5Z3C6xqkMud4iXb/lsYme4g66wF0wjPFCtNreAEr/J4
kU0b2FIQxbFwVWCyresFeaAaLEggf2Sd1YBjlNHz4nwt+AU/5UFOXj/4WBo+
MaxFBw7akJGuPqQH62hlm7NsDGC/FvZhlmAIfGCuuLsUOwwuCSWF7384Ahbh
qJ6xvkZwmfmafZvaBL6al+hbeGIU7CZpk0snvoK7GzJ3eorGwc41B0k5yyfB
cmZ9IL8dWV/kz+i9bQYbsD+rQxkW8JUBPKeCiewjo7jbspF5CYnil8nIDk9e
nQvJRt60ryB6uwhZICVMBr1BpnCpj4rbkTVh4Uk/OpDdzGf6GjXIdfRB5RYD
8oDxvihgAflSS2uEBDMFXlOktftug8wNwp6WL0NeKkxl+xOQH7Mvu4iJyLEB
0vffSMhSfVd4HRmZXm+0xa1FNvKtFFwfZCHT+VQPBXnxv8C/AZTBQmE=
           "]]}, "Charting`Private`Tag#2"]}}, {}}, <|
     "HighlightElements" -> <|
       "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
      "LayoutOptions" -> <|
       "PanelPlotLayout" -> <||>, "PlotRange" -> {{-1.2, 1.2}, {-1.2, 1.2}}, 
        "Frame" -> {{False, False}, {False, False}}, "AxesOrigin" -> {0, 0}, 
        "ImageSize" -> {360, 432}, "Axes" -> {True, True}, "LabelStyle" -> {},
         "AspectRatio" -> Automatic, "DefaultStyle" -> {
          Directive[
           Opacity[1.], 
           AbsoluteThickness[2], 
           FaceForm[
            Opacity[0.3]], 
           GrayLevel[0], 
           Dashing[{Small, Small}], 
           Thickness[Tiny]], 
          Directive[
           Opacity[1.], 
           AbsoluteThickness[2], 
           FaceForm[
            Opacity[0.3]], 
           GrayLevel[0], 
           Dashing[{Small, Small}], 
           Thickness[Tiny]]}, 
        "HighlightLabelingFunctions" -> <|
         "CoordinatesToolOptions" -> Identity, 
          "ScalingFunctions" -> {{Identity, Identity}, {
            Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> False|>, 
      "Meta" -> <|
       "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
        ParametricPlot, "GroupHighlight" -> False|>|>, "DynamicHighlight"]]},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Epilog->{{}, 
    StyleBox[
     LineBox[{{-0.8763664090530131, -1.33191962071203}, {1.7826384605165098`, 
      2.3571552511877925`}}], {
      Directive[
       Dashing[{0, Small}], 
       AbsoluteThickness[2], 
       RGBColor[1, 0, 0]]}, StripOnInput -> False]},
  Frame->{{True, True}, {True, True}},
  FrameLabel->{{
     FormBox[
      TagBox["\"CFS deficit quantiles\"", HoldForm], TraditionalForm], None}, {
     FormBox[
      TagBox["\"County deficit quantiles\"", HoldForm], TraditionalForm], 
     None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "DefaultPlotStyle" -> {
      Directive[
       RGBColor[0.368417, 0.506779, 0.709798], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.880722, 0.611041, 0.142051], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.560181, 0.691569, 0.194885], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.922526, 0.385626, 0.209179], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.528488, 0.470624, 0.701351], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.772079, 0.431554, 0.102387], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.363898, 0.618501, 0.782349], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[1, 0.75, 0], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.647624, 0.37816, 0.614037], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.571589, 0.586483, 0.], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.915, 0.3325, 0.2125], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
       AbsoluteThickness[2]]}, "DomainPadding" -> Scaled[0.02], 
    "PointSizeFunction" -> "SmallPointSize", "RangePadding" -> Scaled[0.05], 
    "OptimizePlotMarkers" -> True, "IncludeHighlighting" -> "CurrentPoint", 
    "HighlightStyle" -> Automatic, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotLabel->FormBox[
   "\"Q-Q plot of county vs cfs deficits\"", TraditionalForm],
  PlotRange->{{-1.2, 1.2}, {-1.2, 1.2}},
  PlotRangeClipping->True,
  PlotRangePadding->{{0, 0}, {0, 0}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.9465727736532173`*^9},
 CellLabel->
  "Out[150]=",ExpressionUUID->"cae05e0c-7877-164c-a355-aeb55a7d0037"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"deficit", "=", 
   RowBox[{"resExpenditure", "-", "resIncome"}]}], ";"}]], "Input",
 CellChangeTimes->{3.946572797161625*^9},
 CellLabel->
  "In[151]:=",ExpressionUUID->"de168312-5efb-f345-a476-1ef9dfcdcfce"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Min", "[", 
  RowBox[{"resIncome", "+", "deficit"}], "]"}]], "Input",
 CellLabel->
  "In[152]:=",ExpressionUUID->"cead8e2a-b4c2-4840-8bf5-4408c146f159"],

Cell[BoxData["0.6463915749287384`"], "Output",
 CellChangeTimes->{3.9465728015816*^9},
 CellLabel->
  "Out[152]=",ExpressionUUID->"730798df-dc30-1b4b-8025-e2d20b583946"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"prodOnlyTrading", "=", 
   RowBox[{"productivities", "[", 
    RowBox[{
    "workplaceEmp", ",", "workplaceWage", ",", "resExpenditure", ",", 
     "distancesOnlyTrading", ",", "0"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{3.9465729802431126`*^9},
 CellLabel->
  "In[159]:=",ExpressionUUID->"85cb9250-55be-6e4d-9de5-f090139ce2f4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Pi]niOnlyTrading", ",", "tradeOnlyTrading"}], "}"}], "=", 
   RowBox[{"trade", "[", 
    RowBox[{
    "prodOnlyTrading", ",", "workplaceEmp", ",", "workplaceWage", ",", 
     "resExpenditure", ",", "distancesOnlyTrading"}], "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[155]:=",ExpressionUUID->"16c483db-2c7b-1242-92ed-2b6e09d80e66"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Min", "[", 
    RowBox[{"Total", "[", "\[Pi]niOnlyTrading", "]"}], "]"}], ",", 
   RowBox[{"Max", "[", 
    RowBox[{"Total", "[", "\[Pi]niOnlyTrading", "]"}], "]"}]}], 
  "}"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Min", "[", 
    FractionBox[
     RowBox[{"Total", "[", "tradeOnlyTrading", "]"}], "resExpenditure"], 
    "]"}], ",", 
   RowBox[{"Max", "[", 
    FractionBox[
     RowBox[{"Total", "[", "tradeOnlyTrading", "]"}], "resExpenditure"], 
    "]"}]}], "}"}]}], "Input",
 CellLabel->
  "In[156]:=",ExpressionUUID->"487d29ce-0eda-a846-80ce-7d7e3328e4e7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.9999999999999918`", ",", "1.0000000000000049`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.946572929851185*^9},
 CellLabel->
  "Out[156]=",ExpressionUUID->"53fefcc1-e081-e64c-bf01-a3e874112997"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.9999999999999918`", ",", "1.0000000000000053`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.946572929883236*^9},
 CellLabel->
  "Out[157]=",ExpressionUUID->"283dc336-fefd-1d40-98a6-ab28c31fe16a"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"gammahatChanges", "[", 
    RowBox[{
    "khat_", ",", "dhat_", ",", "ahat_", ",", "bhat_", ",", "landel_", ",", 
     "outputEvery_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "dist", ",", "c", ",", "what", ",", "\[Lambda]hat", ",", "inWhat", ",", 
       "in\[Lambda]", ",", "out", ",", "iter\[Lambda]tilde", ",", 
       "iterWtilde", ",", "distWages", ",", "dist\[Lambda]", ",", 
       "\[IndentingNewLine]", "temp1", ",", "denRes", ",", "numRes", ",", 
       "Vbarhat", ",", "LMhat", ",", "LRhat", ",", "Qhat", ",", "temp2", ",", 
       "den", ",", "num", ",", "\[Pi]nihat", ",", "diag", ",", "Phat", ",", 
       "pricehat", ",", "realinchat"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dist", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"what", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"1", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "ncounties"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Lambda]hat", "=", "isCommuting"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gamma", " ", "=", " ", "0.7"}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"c", "<", "maxiter"}], " ", "&&", " ", 
         RowBox[{"dist", ">", "tol"}]}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"c", "=", 
          RowBox[{"c", "+", "1"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"inWhat", "=", "what"}], ";", "\[IndentingNewLine]", 
         RowBox[{"in\[Lambda]", "=", "\[Lambda]hat"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"out", "=", 
          RowBox[{"allChangesGuess", "[", 
           RowBox[{
           "inWhat", ",", "in\[Lambda]", ",", "khat", ",", "dhat", ",", 
            "ahat", ",", "bhat", ",", "landel"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"iter\[Lambda]tilde", "=", 
          RowBox[{
           RowBox[{"out", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"1", ";;", "ncounties"}], ",", "All"}], "]"}], "]"}], 
           " ", "isCommutingSp"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"iterWtilde", "=", 
          RowBox[{"out", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"ncounties", "+", "1"}], ",", "All"}], "]"}], "]"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"distWages", "=", 
          RowBox[{"Max", "[", 
           RowBox[{"Abs", "[", 
            RowBox[{
             FractionBox["iterWtilde", "inWhat"], "-", "1"}], "]"}], "]"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"using", " ", "the", " ", "sparse"}], "-", 
           RowBox[{
           "array", " ", "version", " ", "of", " ", "commuting", " ", 
            "allows", " ", "saving", " ", "time"}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"dist\[Lambda]", "=", 
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{
              FractionBox["iter\[Lambda]tilde", 
               RowBox[{"in\[Lambda]", "+", "isCommutingSp", "-", "1"}]], " ", 
              "-", "1"}], "]"}], " ", "isCommutingSp"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "the", " ", "denominator", " ", "makes", " ", "sure", " ", "that", 
            " ", "the", " ", "division", " ", "by", " ", "zero", " ", "never",
             " ", "occurs"}], ",", " ", 
           RowBox[{
            RowBox[{
            "while", " ", "preserving", " ", "the", " ", "deviations", " ", 
             "for", " ", "observed", " ", "commuting", " ", "pairs"}], ";", 
            " ", "then"}], ",", " ", 
           RowBox[{
           "the", " ", "matrix", " ", "is", " ", "multiplied", " ", "by", " ",
             "commuting", " ", "indicators", " ", "to", " ", "restore", " ", 
            "zero", " ", "change", " ", "where", " ", "there", " ", "are", 
            " ", "no", " ", "commuting", " ", "flows"}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"what", "=", 
          RowBox[{
           RowBox[{"inWhat", " ", "\[Zeta]"}], " ", "+", " ", 
           RowBox[{"iterWtilde", " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", "\[Zeta]"}], ")"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"\[Lambda]hat", "=", 
          RowBox[{
           RowBox[{"in\[Lambda]", "  ", "\[Zeta]"}], " ", "+", " ", 
           RowBox[{"iter\[Lambda]tilde", " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", "\[Zeta]"}], ")"}]}]}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"dist", "=", 
          RowBox[{"Max", "[", 
           RowBox[{"{", 
            RowBox[{"distWages", ",", "dist\[Lambda]"}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"outputEvery", ">", "0"}], " ", "&&", 
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{"c", ",", "outputEvery"}], "]"}], "\[Equal]", "1"}]}], 
           ",", " ", 
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<Iteration \>\"", ",", "c", ",", "\"\<  concluded on \>\"", 
             ",", 
             RowBox[{"DateString", "[", "]"}], ",", " ", 
             "\"\<; distWages is \>\"", ",", "distWages", ",", 
             "\"\<; dist\[Lambda] is \>\"", ",", "dist\[Lambda]", ",", 
             "\"\<.\>\""}], "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"dist", ">", "tol"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<WARNING: Max iterations reached witout satisfying the required \
tolerance. Current sup-norm distances: distWages: \>\"", ",", "distWages", 
          ",", "\"\<; dist\[Lambda]: \>\"", ",", "dist\[Lambda]", ",", 
          "\"\< ...\>\""}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"outputEvery", ">", 
           RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Convergence achieved in \>\"", ",", "c", ",", 
            "\"\< iterations on \>\"", ",", 
            RowBox[{"DateString", "[", "]"}], ",", "\"\<; distWages is \>\"", 
            ",", "distWages", ",", "\"\<; dist\[Lambda] is \>\"", ",", 
            "dist\[Lambda]", ",", "\"\< ...\>\""}], "]"}]}], 
         "\[IndentingNewLine]", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Computing", " ", "equilibrium", " ", "changes"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"vbar", " ", "hat"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"temp1", "=", " ", 
       FractionBox[
        RowBox[{"bhat", " ", "\[Lambda]"}], 
        SuperscriptBox["khat", "\[Epsilon]"]]}], " ", ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"denRes", "=", 
       RowBox[{"temp1", ".", 
        SuperscriptBox["what", "\[Epsilon]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"numRes", "=", 
       RowBox[{"temp1", ".", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["what", 
           RowBox[{"\[Epsilon]", "+", "1"}]], " ", "workplaceWage"}], 
         ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Vbarhat", "=", 
       FractionBox["numRes", 
        RowBox[{"resWage", " ", "denRes"}]]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"lm", " ", "hat", " ", "and", " ", "lr", " ", "hat"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"note", ":", " ", 
         RowBox[{"\[Lambda]", " ", "are", " ", "already", " ", "flows"}]}], 
        ",", " ", 
        RowBox[{
         RowBox[{"i", ".", "e", ".", " ", "shares"}], " ", "times", " ", 
         "Lbar", " ", "in", " ", "the", " ", "equations"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"temp1", "=", 
       RowBox[{"\[Lambda]", " ", "\[Lambda]hat"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"LMhat", "=", 
       FractionBox[
        RowBox[{"Total", "[", "temp1", "]"}], "workplaceEmp"]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"LRhat", "=", 
       FractionBox[
        RowBox[{"Total", "[", 
         RowBox[{"Transpose", "[", "temp1", "]"}], "]"}], "resEmp"]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"q", " ", "hat"}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Qhat", "=", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{
           RowBox[{"resIncome", " ", "Vbarhat", " ", "LRhat"}], "+", 
           "deficit"}], 
          RowBox[{"resIncome", "+", "deficit"}]], ")"}], 
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{"1", "+", "landel"}], ")"}]}]]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"\[Pi]ni", " ", "hat"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"temp1", "=", 
       RowBox[{"\[Pi]niOnlyTrading", " ", 
        SuperscriptBox["dhat", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Sigma]"}], ")"}]]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"temp2", "=", 
       RowBox[{"LMhat", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox["what", "ahat"], ")"}], 
         RowBox[{"1", "-", "\[Sigma]"}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"den", "=", 
       RowBox[{"temp2", ".", "temp1"}]}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"note", " ", "that", " ", "left"}], "-", 
        RowBox[{
        "product", " ", "effectively", " ", "gives", " ", "the", " ", 
         "transpose", " ", "of", " ", "temp1", " ", "times", " ", 
         RowBox[{"temp2", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"num", "=", 
       RowBox[{
        SuperscriptBox["dhat", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Sigma]"}], ")"}]], " ", "temp2"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Pi]nihat", "=", 
       RowBox[{"Transpose", "[", 
        FractionBox[
         RowBox[{"Transpose", "[", "num", "]"}], "den"], "  ", "]"}]}], " ", 
      ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "the", " ", "term", " ", "inside", " ", "divides", " ", "each", " ", 
         "column", " ", "by", " ", "the", " ", "correspondent", " ", 
         "element", " ", "of", " ", "the", " ", "denominator"}], ";", " ", 
        RowBox[{
        "it", " ", "then", " ", "brings", " ", "the", " ", "matrix", " ", 
         "in", " ", "the", " ", "original", " ", "form"}]}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"P", " ", "hat"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"diag", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"\[Pi]nihat", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "ncounties"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Phat", "=", 
       RowBox[{
        FractionBox["what", "ahat"], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           FractionBox["LMhat", "diag"], "*", 
           FractionBox["1", 
            RowBox[{"1", "+", " ", "gamma"}]]}], ")"}], 
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Sigma]"}], ")"}]}]]}]}], "  ", ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"price", " ", "index", " ", "hat"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"pricehat", "=", 
       RowBox[{
        SuperscriptBox["Phat", "\[Alpha]"], 
        SuperscriptBox["Qhat", 
         RowBox[{"1", "-", "\[Alpha]"}]]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"real", " ", "income", " ", "of", " ", "residents"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"realinchat", "=", 
       FractionBox["Vbarhat", "pricehat"]}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"outputEvery", ">", 
         RowBox[{"-", "1"}]}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Counterfactuals completed on \>\"", ",", 
          RowBox[{"DateString", "[", "]"}], ",", "\"\<.\>\""}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "what", ",", "Vbarhat", ",", "realinchat", ",", "LMhat", ",", "LRhat", 
        ",", "Qhat", ",", "Phat", ",", "pricehat", ",", "\[Lambda]hat", ",", 
        "\[Pi]nihat", ",", "c", ",", "distWages", ",", "dist\[Lambda]"}], 
       "}"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.9465733185839424`*^9, 3.9465733324580536`*^9}, {
   3.94657337778833*^9, 3.9465734090326786`*^9}, {3.9465734720357704`*^9, 
   3.9465735537245255`*^9}, {3.9465738895574455`*^9, 3.946573959017559*^9}, 
   3.94657403293404*^9},
 CellLabel->
  "In[207]:=",ExpressionUUID->"7d42b72d-4fe1-674d-862e-e3e3cc109f76"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.946573579975418*^9, 3.946573582992586*^9}, {
   3.9465736464304485`*^9, 3.946573670592333*^9}, 
   3.94657388585462*^9},ExpressionUUID->"8afc4d4a-0878-b542-b77e-\
c23fbe8dfeed"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"tolerance", ",", " ", 
    RowBox[{"max", " ", "number", " ", "of", " ", "iterations"}], ",", " ", 
    RowBox[{"speed", " ", "of", " ", "adjustment"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"tol", "=", 
     SuperscriptBox["10", 
      RowBox[{"-", "6"}]]}], ";", " ", 
    RowBox[{"maxiter", "=", "1000"}], ";", " ", 
    RowBox[{"\[Zeta]", "=", "0.7"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"change", " ", "in", " ", "commuting", " ", "costs"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"comch", "=", 
     SuperscriptBox[".6601334", 
      RowBox[{"1", "/", "\[Epsilon]"}]]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"khat", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"1", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "ncounties"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "ncounties"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"khat", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "i"}], "]"}], "]"}], "=", "1"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "ncounties"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dhat", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"1", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "ncounties"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "ncounties"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ahat", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"1", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "ncounties"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"bhat", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"1", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "ncounties"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "ncounties"}], "}"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{3.946573784558468*^9},
 CellLabel->
  "In[208]:=",ExpressionUUID->"800f3ed4-d64a-aa4d-8d39-289f7d1a370a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"khat", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{"1", ";;", "4"}], ",", 
     RowBox[{"1", ";;", "4"}]}], "]"}], "]"}], "//", "MatrixForm"}]], "Input",
 CellLabel->
  "In[215]:=",ExpressionUUID->"fd264f26-6092-5448-aa2d-dbce1cd3488e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "1", "1", "1"},
     {"1", "1", "1", "1"},
     {"1", "1", "1", "1"},
     {"1", "1", "1", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.946573723871546*^9, 3.9465737878360023`*^9, 
  3.946573965436634*^9, 3.9465740378129654`*^9},
 CellLabel->
  "Out[215]//MatrixForm=",ExpressionUUID->"1f0c9dbd-60ac-bc45-9176-\
2ffc8d895cea"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"comm", "=", 
  RowBox[{"gammahatChanges", "[", 
   RowBox[{
   "khat", ",", "dhat", ",", "ahat", ",", "bhat", ",", "\[Eta]zero", ",", 
    "25"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9465739714461956`*^9, 3.946573971844778*^9}},
 CellLabel->
  "In[216]:=",ExpressionUUID->"1cf6375b-cada-de45-86db-98ff6ea607c6"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Iteration \"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"  concluded on \"\>", 
   "\[InvisibleSpace]", "\<\"Wed 22 Jan 2025 16:34:02\"\>", 
   "\[InvisibleSpace]", "\<\"; distWages is \"\>", "\[InvisibleSpace]", 
   "9.174493093011549`*^-7", 
   "\[InvisibleSpace]", "\<\"; dist\[Lambda] is \"\>", "\[InvisibleSpace]", 
   "1.1805746145121532`*^-6", "\[InvisibleSpace]", "\<\".\"\>"}],
  SequenceForm[
  "Iteration ", 1, "  concluded on ", "Wed 22 Jan 2025 16:34:02", 
   "; distWages is ", 9.174493093011549*^-7, "; dist\[Lambda] is ", 
   1.1805746145121532`*^-6, "."],
  Editable->False]], "Print",
 CellChangeTimes->{3.9465739760360546`*^9, 3.9465740421904507`*^9},
 CellLabel->
  "During evaluation of \
In[216]:=",ExpressionUUID->"42122999-87bb-8b4b-83d3-db64386a79a3"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Convergence achieved in \"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\" iterations on \"\>", 
   "\[InvisibleSpace]", "\<\"Wed 22 Jan 2025 16:34:05\"\>", 
   "\[InvisibleSpace]", "\<\"; distWages is \"\>", "\[InvisibleSpace]", 
   "7.911255957004926`*^-7", 
   "\[InvisibleSpace]", "\<\"; dist\[Lambda] is \"\>", "\[InvisibleSpace]", 
   "4.6038974177431413`*^-7", "\[InvisibleSpace]", "\<\" ...\"\>"}],
  SequenceForm[
  "Convergence achieved in ", 2, " iterations on ", 
   "Wed 22 Jan 2025 16:34:05", "; distWages is ", 7.911255957004926*^-7, 
   "; dist\[Lambda] is ", 4.6038974177431413`*^-7, " ..."],
  Editable->False]], "Print",
 CellChangeTimes->{3.9465739760360546`*^9, 3.9465740455845337`*^9},
 CellLabel->
  "During evaluation of \
In[216]:=",ExpressionUUID->"1f452152-6372-2a46-82c4-415b7f4feb12"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Counterfactuals completed on \"\>", 
   "\[InvisibleSpace]", "\<\"Wed 22 Jan 2025 16:34:07\"\>", 
   "\[InvisibleSpace]", "\<\".\"\>"}],
  SequenceForm[
  "Counterfactuals completed on ", "Wed 22 Jan 2025 16:34:07", "."],
  Editable->False]], "Print",
 CellChangeTimes->{3.9465739760360546`*^9, 3.9465740472732983`*^9},
 CellLabel->
  "During evaluation of \
In[216]:=",ExpressionUUID->"fbf5784c-9d5e-1a45-a330-021f0516a85c"]
}, Open  ]],

Cell[BoxData[
 TemplateBox[<|"shortenedBoxes" -> TagBox[
     RowBox[{"{", 
       RowBox[{
         RowBox[{"{", 
           
           RowBox[{"0.9999999998580137`", ",", "0.9999999970079547`", ",", 
             "0.9999999989866442`", ",", "1.0000000036131032`", ",", 
             "1.0000000044082087`", ",", "0.999999999013318`", ",", 
             "0.9999999985394877`", ",", "1.0000000041443118`", ",", 
             "1.0000000022293574`", ",", "1.0000000035960175`", ",", 
             "1.0000000026322766`", ",", "1.0000000002148837`", ",", 
             "0.9999999998113799`", ",", "1.000000003189132`", ",", 
             "1.000000003590779`", ",", "0.9999999972242866`", ",", 
             "1.0000000009874015`", ",", "0.999999999562182`", ",", 
             "1.0000000029112575`", ",", "0.9999999987198207`", ",", 
             "0.9999999981688121`", ",", "1.0000000037610652`", ",", 
             "0.9999999980587262`", ",", "1.0000000008332643`", ",", 
             "1.0000000042242894`", ",", "1.0000000013202888`", ",", 
             "0.9999999997410595`", ",", "1.000000004176234`", ",", 
             "1.000000002469749`", ",", "1.0000000016494535`", ",", 
             "0.99999999723059`", ",", 
             TemplateBox[{"3049"}, "OutputSizeLimit`Skeleton"], ",", 
             "0.9999999993593387`", ",", "1.000000002107539`", ",", 
             "1.000000000319439`", ",", "0.9999999952220396`", ",", 
             "0.9999999986844803`", ",", "1.0000000006172487`", ",", 
             "1.000000004952779`", ",", "1.0000000014097228`", ",", 
             "0.9999999956898491`", ",", "0.999999995946506`", ",", 
             "0.9999999933692711`", ",", "0.9999999940040172`", ",", 
             "0.9999999950469383`", ",", "0.9999999956166774`", ",", 
             "0.9999999940463997`", ",", "0.9999999951577709`", ",", 
             "0.9999999952494498`", ",", "0.9999999947376116`", ",", 
             "0.9999999946234452`", ",", "0.9999999939492352`", ",", 
             "0.9999999935694026`", ",", "0.9999999955421721`", ",", 
             "0.9999999963454838`", ",", "0.9999999953610841`", ",", 
             "0.9999999956384106`", ",", "0.99999999380908`", ",", 
             "0.9999999933092452`", ",", "0.9999999936012725`", ",", 
             "0.9999999935068433`", ",", "0.9999999953064027`", ",", 
             "0.9999999951065714`"}], "}"}], ",", 
         TemplateBox[{"11"}, "OutputSizeLimit`Skeleton"], ",", 
         TemplateBox[{"23"}, "OutputSizeLimit`Skeleton"]}], "}"}], 
     Short[#, 8]& ], "line" -> 216, "sessionID" -> 31003028359064829394, 
   "byteCount" -> 155158720, "size" -> 8, "stored" -> False, "expr" -> 
   Missing["NotStored"], "wrap" -> OutputSizeLimit`Defer, "version" -> 1|>,
  "OutputSizeLimitTemplate"]], "Output",
 CellChangeTimes->{3.9465739934243793`*^9, 3.9465740592182426`*^9},
 CellLabel->
  "Out[216]=",ExpressionUUID->"f4bb6585-d15b-8047-8eab-58c25452b17c"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "whatOut", ",", "VbarhatOut", ",", "realinchatOut", ",", "LMhatOut", ",", 
     "LRhatOut", ",", "QhatOut", ",", "PhatOut", ",", "pricehatOut", ",", 
     "\[Lambda]hatOut", ",", "\[Pi]nihatOut", ",", "c", ",", "distWages", ",",
      "dist\[Lambda]"}], "}"}], "=", 
   RowBox[{"comm", "-", "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"varnames", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "\"\<WHat\>\"", "}"}], ",", 
     RowBox[{"{", "\"\<VbarHat\>\"", "}"}], ",", 
     RowBox[{"{", "\"\<RealIncHat\>\"", "}"}], ",", 
     RowBox[{"{", "\"\<LMhat\>\"", "}"}], ",", 
     RowBox[{"{", "\"\<LRhat\>\"", "}"}], ",", 
     RowBox[{"{", "\"\<QHat\>\"", "}"}], ",", 
     RowBox[{"{", "\"\<PHat\>\"", "}"}], ",", 
     RowBox[{"{", "\"\<PriceHat\>\"", "}"}], ",", 
     RowBox[{"{", "\"\<OwnCommutingHat\>\"", "}"}], ",", 
     RowBox[{"{", "\"\<OwnTradeHat\>\"", "}"}], ",", 
     RowBox[{"{", "\"\<ownTrade\>\"", "}"}]}], "}"}]}], ";"}]}], "Input",
 CellLabel->
  "In[227]:=",ExpressionUUID->"33e0b199-4800-744a-8158-50c1a5927fb3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ownCommHat", "=", 
   RowBox[{"Diagonal", "[", "\[Lambda]hatOut", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ownTradeHat", "=", 
   RowBox[{"Diagonal", "[", "\[Pi]nihatOut", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"varnames", ",", 
     RowBox[{"{", 
      RowBox[{
      "whatOut", ",", "VbarhatOut", ",", "realinchatOut", ",", "LMhatOut", 
       ",", "LRhatOut", ",", "QhatOut", ",", "PhatOut", ",", "pricehatOut", 
       ",", "ownCommHat", ",", "ownTradeHat", ",", 
       RowBox[{"Diagonal", "[", "\[Pi]niOnlyTrading", "]"}]}], "}"}], ",", 
     "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"Transpose", "[", "out", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"countyNames", ",", "out", ",", "2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<data\\\\gamma_stuff.csv\>\"", ",", "out"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wel", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"whatOut", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "+", "1"}], 
       RowBox[{
        RowBox[{"khat", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "i"}], "]"}], "]"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Lambda]hatOut", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "i"}], "]"}], "]"}], "+", "1"}], ")"}], 
         RowBox[{"1", "/", "\[Epsilon]"}]], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"PhatOut", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "+", "1"}], ")"}], "\[Alpha]"], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"QhatOut", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "+", "1"}], ")"}], 
         RowBox[{"1", "-", "\[Alpha]"}]]}]], " ", 
      SuperscriptBox[
       RowBox[{"bhat", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "i"}], "]"}], "]"}], 
       RowBox[{"1", "/", "\[Epsilon]"}]], " ", "*", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox["gamma", 
           RowBox[{"gamma", "+", "1"}]], ")"}], "gamma"], " ", "-", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox["gamma", 
           RowBox[{"gamma", "+", "1"}]], ")"}], 
         RowBox[{"gamma", "+", "1"}]]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "ncounties"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Min", "[", "wel", "]"}], ",", 
   RowBox[{"Max", "[", "wel", "]"}]}], "}"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.9465740182255096`*^9, 3.9465740195653877`*^9}, {
  3.946574063926401*^9, 3.9465740982756214`*^9}},
 CellLabel->
  "In[245]:=",ExpressionUUID->"ba209273-b200-774e-aa58-7222e0b0acf1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.28425993723956167`", ",", "0.284259963289852`"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.9465740210759544`*^9, {3.946574060440235*^9, 3.946574061583391*^9}, 
   3.946574100247982*^9, 3.9465757917928104`*^9},
 CellLabel->
  "Out[252]=",ExpressionUUID->"65700e06-4b07-6a46-868f-0a816b5d8817"]
}, Open  ]],

Cell[BoxData[" "], "Input",
 CellChangeTimes->{
  3.946574350002432*^9},ExpressionUUID->"d241b664-de22-e540-8d54-\
c9a5bddb5164"]
},
WindowSize->{1635.4285714285713`, 607.7142857142857},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"14.1 for Microsoft Windows (64-bit) (July 16, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"e2e1f67b-e1e9-954c-b0a7-5c4e241b2eef"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[554, 20, 323, 8, 47, "Input",ExpressionUUID->"0e367fcf-046a-6940-8c58-b6f3b63fe78e"],
Cell[880, 30, 5313, 143, 486, "Input",ExpressionUUID->"a6207549-691b-7f47-b1c4-059b2afe603e"],
Cell[6196, 175, 969, 28, 85, "Input",ExpressionUUID->"0dd42738-babb-f640-8f8a-f4eb5cecf765"],
Cell[CellGroupData[{
Cell[7190, 207, 419, 11, 66, "Input",ExpressionUUID->"bcf6df65-b212-9e4c-aa51-94571a979388"],
Cell[7612, 220, 201, 5, 32, "Output",ExpressionUUID->"172ce6c3-2bb9-124f-8b3e-4d0ee9330fb8"],
Cell[7816, 227, 416, 13, 32, "Output",ExpressionUUID->"34d35363-5cf8-a849-aa84-f063e5ba751b"]
}, Open  ]],
Cell[8247, 243, 951, 26, 104, "Input",ExpressionUUID->"57f2f3bf-7fef-7844-b4ca-36755c2c62b6"],
Cell[9201, 271, 1113, 33, 85, "Input",ExpressionUUID->"c20e2123-af1c-bd4c-9712-c1ef4aa05c9a"],
Cell[10317, 306, 203, 5, 28, "Input",ExpressionUUID->"0016ae11-3f43-4c40-8224-938df79d7772"],
Cell[10523, 313, 1802, 46, 180, "Input",ExpressionUUID->"bbe0bb9b-c140-a245-b586-ff7fa436b977"],
Cell[12328, 361, 7854, 190, 856, "Input",ExpressionUUID->"296030a4-96ee-1841-991d-5522d6ed0bee"],
Cell[20185, 553, 2810, 72, 317, "Input",ExpressionUUID->"62e2888c-b85b-2d43-81a5-e476ad8dcb15"],
Cell[22998, 627, 11580, 266, 1376, "Input",ExpressionUUID->"dca763c1-b804-ce48-bead-3dfddfc5f702"],
Cell[34581, 895, 1807, 53, 123, "Input",ExpressionUUID->"a22d5c39-cfae-0142-a93d-beea3796d376"],
Cell[CellGroupData[{
Cell[36413, 952, 362, 10, 28, "Input",ExpressionUUID->"3b720b1a-c79a-f441-a962-1068c0fa3dac"],
Cell[36778, 964, 158, 3, 32, "Output",ExpressionUUID->"53f4242b-f31b-6846-a899-78bd8d51aaae"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36973, 972, 322, 8, 47, "Input",ExpressionUUID->"8d1df9c3-060b-064a-9174-73f275edb1b2"],
Cell[37298, 982, 204, 5, 32, "Output",ExpressionUUID->"0c8552ea-706d-244c-b3d0-05c74d709cb0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37539, 992, 2213, 64, 171, "Input",ExpressionUUID->"082bc60a-a908-b54e-9b26-206d9505523a"],
Cell[39755, 1058, 14797, 432, 254, "Output",ExpressionUUID->"66cbc147-bbdf-b541-9491-1de0e46d559c"],
Cell[54555, 1492, 540, 12, 22, "Print",ExpressionUUID->"002fa1d0-9d9e-8b47-83dc-a4050dedb52e"],
Cell[55098, 1506, 839, 27, 160, "Output",ExpressionUUID->"5ee9e362-4b1c-7a41-a12e-1a2db69fed7b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55974, 1538, 1131, 35, 85, "Input",ExpressionUUID->"e2cebad6-257a-e140-b46d-1427fed2fa8c"],
Cell[57108, 1575, 176, 3, 32, "Output",ExpressionUUID->"6f7e6bd7-d07a-3f47-9e75-f78f5ab91a73"]
}, Open  ]],
Cell[57299, 1581, 321, 10, 46, "Input",ExpressionUUID->"b62a69af-acf9-d049-bacd-c8b25f28a568"],
Cell[57623, 1593, 324, 9, 28, "Input",ExpressionUUID->"7cb86c3c-bd0b-2649-93b9-dad6674693b1"],
Cell[57950, 1604, 2087, 65, 126, "Input",ExpressionUUID->"3f3583e4-99ca-bd4f-9b5c-d573c3a2253c"],
Cell[CellGroupData[{
Cell[60062, 1673, 2074, 61, 169, "Input",ExpressionUUID->"200c811e-0c21-ba49-823c-58a4dd9c7cec"],
Cell[62139, 1736, 12545, 363, 251, "Output",ExpressionUUID->"b4a4559a-0954-f246-96a9-048cd1ff0fa0"],
Cell[74687, 2101, 543, 12, 22, "Print",ExpressionUUID->"9acb6d5a-cd2a-c74b-bf52-b4fa95d10234"],
Cell[75233, 2115, 841, 27, 160, "Output",ExpressionUUID->"74a88abe-7077-f047-a0ee-8ba6b192becc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[76111, 2147, 1428, 41, 85, "Input",ExpressionUUID->"fd57cd7a-2820-5f40-b99d-6f99ca0d9076"],
Cell[77542, 2190, 27979, 593, 259, "Output",ExpressionUUID->"cae05e0c-7877-164c-a355-aeb55a7d0037"]
}, Open  ]],
Cell[105536, 2786, 243, 6, 28, "Input",ExpressionUUID->"de168312-5efb-f345-a476-1ef9dfcdcfce"],
Cell[CellGroupData[{
Cell[105804, 2796, 176, 4, 28, "Input",ExpressionUUID->"cead8e2a-b4c2-4840-8bf5-4408c146f159"],
Cell[105983, 2802, 169, 3, 32, "Output",ExpressionUUID->"730798df-dc30-1b4b-8025-e2d20b583946"]
}, Open  ]],
Cell[106167, 2808, 371, 9, 28, "Input",ExpressionUUID->"85cb9250-55be-6e4d-9de5-f090139ce2f4"],
Cell[106541, 2819, 399, 10, 28, "Input",ExpressionUUID->"16c483db-2c7b-1242-92ed-2b6e09d80e66"],
Cell[CellGroupData[{
Cell[106965, 2833, 641, 19, 67, "Input",ExpressionUUID->"487d29ce-0eda-a846-80ce-7d7e3328e4e7"],
Cell[107609, 2854, 237, 6, 32, "Output",ExpressionUUID->"53fefcc1-e081-e64c-bf01-a3e874112997"],
Cell[107849, 2862, 237, 6, 32, "Output",ExpressionUUID->"283dc336-fefd-1d40-98a6-ab28c31fe16a"]
}, Open  ]],
Cell[108101, 2871, 14036, 324, 1835, "Input",ExpressionUUID->"7d42b72d-4fe1-674d-862e-e3e3cc109f76"],
Cell[122140, 3197, 226, 4, 28, "Input",ExpressionUUID->"8afc4d4a-0878-b542-b77e-c23fbe8dfeed"],
Cell[122369, 3203, 2305, 67, 199, "Input",ExpressionUUID->"800f3ed4-d64a-aa4d-8d39-289f7d1a370a"],
Cell[CellGroupData[{
Cell[124699, 3274, 276, 8, 28, "Input",ExpressionUUID->"fd264f26-6092-5448-aa2d-dbce1cd3488e"],
Cell[124978, 3284, 768, 22, 93, "Output",ExpressionUUID->"1f0c9dbd-60ac-bc45-9176-2ffc8d895cea"]
}, Open  ]],
Cell[CellGroupData[{
Cell[125783, 3311, 340, 8, 28, "Input",ExpressionUUID->"1cf6375b-cada-de45-86db-98ff6ea607c6"],
Cell[CellGroupData[{
Cell[126148, 3323, 841, 17, 22, "Print",ExpressionUUID->"42122999-87bb-8b4b-83d3-db64386a79a3"],
Cell[126992, 3342, 875, 17, 22, "Print",ExpressionUUID->"1f452152-6372-2a46-82c4-415b7f4feb12"],
Cell[127870, 3361, 474, 11, 22, "Print",ExpressionUUID->"fbf5784c-9d5e-1a45-a330-021f0516a85c"]
}, Open  ]],
Cell[128359, 3375, 2927, 47, 75, "Output",ExpressionUUID->"f4bb6585-d15b-8047-8eab-58c25452b17c"]
}, Open  ]],
Cell[131301, 3425, 1128, 26, 47, "Input",ExpressionUUID->"33e0b199-4800-744a-8158-50c1a5927fb3"],
Cell[CellGroupData[{
Cell[132454, 3455, 3138, 89, 204, "Input",ExpressionUUID->"ba209273-b200-774e-aa58-7222e0b0acf1"],
Cell[135595, 3546, 338, 8, 32, "Output",ExpressionUUID->"65700e06-4b07-6a46-868f-0a816b5d8817"]
}, Open  ]],
Cell[135948, 3557, 129, 3, 28, "Input",ExpressionUUID->"d241b664-de22-e540-8d54-c9a5bddb5164"]
}
]
*)

